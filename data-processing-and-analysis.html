<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Data processing and analysis | Identifying partners at sea on contrasting fisheries around the world</title>
  <meta name="description" content="Characterizing dyadic joing movement in world fisheries" />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Data processing and analysis | Identifying partners at sea on contrasting fisheries around the world" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Characterizing dyadic joing movement in world fisheries" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Data processing and analysis | Identifying partners at sea on contrasting fisheries around the world" />
  
  <meta name="twitter:description" content="Characterizing dyadic joing movement in world fisheries" />
  

<meta name="author" content="Rocío Joo, Nicolas Bez, Marie-Pierre Etienne, Pablo Marin, Nicolas Goascoz, and Stéphanie Mahévas" />


<meta name="date" content="2020-09-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="supplementary-results.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Abstract of the manuscript</a></li>
<li class="chapter" data-level="2" data-path="data-processing-and-analysis.html"><a href="data-processing-and-analysis.html"><i class="fa fa-check"></i><b>2</b> Data processing and analysis</a><ul>
<li class="chapter" data-level="2.1" data-path="data-processing-and-analysis.html"><a href="data-processing-and-analysis.html#setting-up-configuration-previous-to-the-analysis"><i class="fa fa-check"></i><b>2.1</b> Setting up configuration previous to the analysis</a></li>
<li class="chapter" data-level="2.2" data-path="data-processing-and-analysis.html"><a href="data-processing-and-analysis.html#gaussian-mixture-modeling"><i class="fa fa-check"></i><b>2.2</b> Gaussian mixture modeling</a></li>
<li class="chapter" data-level="2.3" data-path="data-processing-and-analysis.html"><a href="data-processing-and-analysis.html#classifying-the-dyads-of-the-other-fleets"><i class="fa fa-check"></i><b>2.3</b> Classifying the dyads of the other fleets</a></li>
<li class="chapter" data-level="2.4" data-path="data-processing-and-analysis.html"><a href="data-processing-and-analysis.html#plots-and-animations-of-dyads-tracks-and-time-series-and-network-graphs"><i class="fa fa-check"></i><b>2.4</b> Plots and animations of dyad’s tracks and time series, and network graphs</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="supplementary-results.html"><a href="supplementary-results.html"><i class="fa fa-check"></i><b>3</b> Supplementary results</a><ul>
<li class="chapter" data-level="3.1" data-path="supplementary-results.html"><a href="supplementary-results.html#pelagic-pair-trawlers"><i class="fa fa-check"></i><b>3.1</b> Pelagic pair trawlers</a><ul>
<li class="chapter" data-level="3.1.1" data-path="supplementary-results.html"><a href="supplementary-results.html#group-1-most-representative-example"><i class="fa fa-check"></i><b>3.1.1</b> Group 1: most representative example</a></li>
<li class="chapter" data-level="3.1.2" data-path="supplementary-results.html"><a href="supplementary-results.html#group-2-most-representative-example"><i class="fa fa-check"></i><b>3.1.2</b> Group 2: most representative example</a></li>
<li class="chapter" data-level="3.1.3" data-path="supplementary-results.html"><a href="supplementary-results.html#group-3-most-representative-example"><i class="fa fa-check"></i><b>3.1.3</b> Group 3: most representative example</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="supplementary-results.html"><a href="supplementary-results.html#large-bottom-otter-trawlers"><i class="fa fa-check"></i><b>3.2</b> Large bottom otter trawlers</a><ul>
<li class="chapter" data-level="3.2.1" data-path="supplementary-results.html"><a href="supplementary-results.html#group-1-most-representative-example-1"><i class="fa fa-check"></i><b>3.2.1</b> Group 1: most representative example</a></li>
<li class="chapter" data-level="3.2.2" data-path="supplementary-results.html"><a href="supplementary-results.html#group-2-most-representative-example-1"><i class="fa fa-check"></i><b>3.2.2</b> Group 2: most representative example</a></li>
<li class="chapter" data-level="3.2.3" data-path="supplementary-results.html"><a href="supplementary-results.html#group-3-most-representative-example-1"><i class="fa fa-check"></i><b>3.2.3</b> Group 3: most representative example</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="supplementary-results.html"><a href="supplementary-results.html#small-bottom-otter-trawlers"><i class="fa fa-check"></i><b>3.3</b> Small bottom otter trawlers</a><ul>
<li class="chapter" data-level="3.3.1" data-path="supplementary-results.html"><a href="supplementary-results.html#group-1-most-representative-example-2"><i class="fa fa-check"></i><b>3.3.1</b> Group 1: most representative example</a></li>
<li class="chapter" data-level="3.3.2" data-path="supplementary-results.html"><a href="supplementary-results.html#group-2-most-representative-example-2"><i class="fa fa-check"></i><b>3.3.2</b> Group 2: most representative example</a></li>
<li class="chapter" data-level="3.3.3" data-path="supplementary-results.html"><a href="supplementary-results.html#group-3-most-representative-example-2"><i class="fa fa-check"></i><b>3.3.3</b> Group 3: most representative example</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="supplementary-results.html"><a href="supplementary-results.html#mid-water-otter-trawlers"><i class="fa fa-check"></i><b>3.4</b> Mid-water otter trawlers</a><ul>
<li class="chapter" data-level="3.4.1" data-path="supplementary-results.html"><a href="supplementary-results.html#group-1-most-representative-example-3"><i class="fa fa-check"></i><b>3.4.1</b> Group 1: most representative example</a></li>
<li class="chapter" data-level="3.4.2" data-path="supplementary-results.html"><a href="supplementary-results.html#group-2-most-representative-example-3"><i class="fa fa-check"></i><b>3.4.2</b> Group 2: most representative example</a></li>
<li class="chapter" data-level="3.4.3" data-path="supplementary-results.html"><a href="supplementary-results.html#group-3-most-representative-example-3"><i class="fa fa-check"></i><b>3.4.3</b> Group 3: most representative example</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="supplementary-results.html"><a href="supplementary-results.html#anchovy-purse-seiners"><i class="fa fa-check"></i><b>3.5</b> Anchovy purse-seiners</a><ul>
<li class="chapter" data-level="3.5.1" data-path="supplementary-results.html"><a href="supplementary-results.html#group-1-most-representative-example-4"><i class="fa fa-check"></i><b>3.5.1</b> Group 1: most representative example</a></li>
<li class="chapter" data-level="3.5.2" data-path="supplementary-results.html"><a href="supplementary-results.html#group-2-most-representative-example-4"><i class="fa fa-check"></i><b>3.5.2</b> Group 2: most representative example</a></li>
<li class="chapter" data-level="3.5.3" data-path="supplementary-results.html"><a href="supplementary-results.html#group-3-most-representative-example-4"><i class="fa fa-check"></i><b>3.5.3</b> Group 3: most representative example</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="supplementary-results.html"><a href="supplementary-results.html#tuna-purse-seiners"><i class="fa fa-check"></i><b>3.6</b> Tuna purse-seiners</a><ul>
<li class="chapter" data-level="3.6.1" data-path="supplementary-results.html"><a href="supplementary-results.html#group-2-most-representative-example-5"><i class="fa fa-check"></i><b>3.6.1</b> Group 2: most representative example</a></li>
<li class="chapter" data-level="3.6.2" data-path="supplementary-results.html"><a href="supplementary-results.html#group-3-most-representative-example-5"><i class="fa fa-check"></i><b>3.6.2</b> Group 3: most representative example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="r-session-information.html"><a href="r-session-information.html"><i class="fa fa-check"></i><b>4</b> R Session Information</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Identifying partners at sea on contrasting fisheries around the world</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-processing-and-analysis" class="section level1">
<h1><span class="header-section-number">2</span> Data processing and analysis</h1>
<p>Due to the large volumes of data involved, and confidentiality agreements for
the majority of the data, we will share the codes starting when the metrics for the dyads have already been computed.
The data shared in this repository are only at the scale of dyads, and not locations.</p>
<div id="setting-up-configuration-previous-to-the-analysis" class="section level2">
<h2><span class="header-section-number">2.1</span> Setting up configuration previous to the analysis</h2>
<p>Calling packages, setting up data, auxiliary code, stats and figure paths, and sourcing functions:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="data-processing-and-analysis.html#cb1-1"></a>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">echo =</span> <span class="ot">FALSE</span>, <span class="dt">warning =</span> <span class="ot">FALSE</span>, <span class="dt">message =</span> <span class="ot">FALSE</span>)</span>
<span id="cb1-2"><a href="data-processing-and-analysis.html#cb1-2"></a><span class="kw">library</span>(lubridate) <span class="co"># date function</span></span>
<span id="cb1-3"><a href="data-processing-and-analysis.html#cb1-3"></a><span class="kw">library</span>(magrittr) <span class="co"># pipes</span></span>
<span id="cb1-4"><a href="data-processing-and-analysis.html#cb1-4"></a><span class="kw">library</span>(stringr) <span class="co">#str_replace_all</span></span>
<span id="cb1-5"><a href="data-processing-and-analysis.html#cb1-5"></a><span class="kw">library</span>(ggplot2) </span>
<span id="cb1-6"><a href="data-processing-and-analysis.html#cb1-6"></a><span class="kw">library</span>(xtable)</span>
<span id="cb1-7"><a href="data-processing-and-analysis.html#cb1-7"></a><span class="kw">library</span>(maps) <span class="co"># get background</span></span>
<span id="cb1-8"><a href="data-processing-and-analysis.html#cb1-8"></a><span class="kw">library</span>(maptools) <span class="co"># map2SpatialPolygons</span></span>
<span id="cb1-9"><a href="data-processing-and-analysis.html#cb1-9"></a><span class="kw">library</span>(mapdata) <span class="co"># worldHires</span></span>
<span id="cb1-10"><a href="data-processing-and-analysis.html#cb1-10"></a><span class="kw">library</span>(animation) <span class="co"># videos</span></span>
<span id="cb1-11"><a href="data-processing-and-analysis.html#cb1-11"></a><span class="kw">library</span>(igraph) <span class="co"># network representation</span></span>
<span id="cb1-12"><a href="data-processing-and-analysis.html#cb1-12"></a><span class="kw">library</span>(viridis)</span>
<span id="cb1-13"><a href="data-processing-and-analysis.html#cb1-13"></a><span class="kw">library</span>(dplyr) <span class="co"># filter, mutate</span></span>
<span id="cb1-14"><a href="data-processing-and-analysis.html#cb1-14"></a><span class="kw">library</span>(Rmixmod)</span>
<span id="cb1-15"><a href="data-processing-and-analysis.html#cb1-15"></a><span class="kw">library</span>(FactoMineR)</span>
<span id="cb1-16"><a href="data-processing-and-analysis.html#cb1-16"></a><span class="kw">library</span>(tidyr) <span class="co"># gather</span></span>
<span id="cb1-17"><a href="data-processing-and-analysis.html#cb1-17"></a><span class="kw">library</span>(mvtnorm) <span class="co"># for overlap index</span></span>
<span id="cb1-18"><a href="data-processing-and-analysis.html#cb1-18"></a></span>
<span id="cb1-19"><a href="data-processing-and-analysis.html#cb1-19"></a>dossier.data.outputs &lt;-<span class="st"> &#39;./DataOutputs/&#39;</span> </span>
<span id="cb1-20"><a href="data-processing-and-analysis.html#cb1-20"></a>dossier.stats.outputs &lt;-<span class="st"> &#39;./StatsPlots/&#39;</span> </span>
<span id="cb1-21"><a href="data-processing-and-analysis.html#cb1-21"></a>dossier.codes &lt;-<span class="st"> &#39;./R/&#39;</span></span>
<span id="cb1-22"><a href="data-processing-and-analysis.html#cb1-22"></a></span>
<span id="cb1-23"><a href="data-processing-and-analysis.html#cb1-23"></a></span>
<span id="cb1-24"><a href="data-processing-and-analysis.html#cb1-24"></a></span>
<span id="cb1-25"><a href="data-processing-and-analysis.html#cb1-25"></a><span class="kw">source</span>(<span class="kw">paste0</span>(dossier.codes, <span class="st">&#39;dyad_info_general_allgears.r&#39;</span>)) <span class="co"># get summary of dyads</span></span>
<span id="cb1-26"><a href="data-processing-and-analysis.html#cb1-26"></a><span class="kw">source</span>(<span class="kw">paste0</span>(dossier.codes, <span class="st">&#39;pre_video_modif_allgears.r&#39;</span>)) <span class="co"># get data into format for video functions</span></span>
<span id="cb1-27"><a href="data-processing-and-analysis.html#cb1-27"></a><span class="kw">source</span>(<span class="kw">paste0</span>(dossier.codes, <span class="st">&#39;VideoHtmlDyadAllGears.r&#39;</span>)) <span class="co"># get animation in html</span></span>
<span id="cb1-28"><a href="data-processing-and-analysis.html#cb1-28"></a><span class="kw">source</span>(<span class="kw">paste0</span>(dossier.codes, <span class="st">&#39;VideoGIFDyadAllGears.R&#39;</span>)) <span class="co"># get animation in gif</span></span>
<span id="cb1-29"><a href="data-processing-and-analysis.html#cb1-29"></a><span class="kw">source</span>(<span class="kw">paste0</span>(dossier.codes, <span class="st">&#39;plot_dyad_general_allgears.R&#39;</span>)) <span class="co"># plot tracks</span></span>
<span id="cb1-30"><a href="data-processing-and-analysis.html#cb1-30"></a><span class="kw">source</span>(<span class="kw">paste0</span>(dossier.codes, <span class="st">&#39;subplot_uni.r&#39;</span>)) <span class="co"># plot metric time series</span></span>
<span id="cb1-31"><a href="data-processing-and-analysis.html#cb1-31"></a><span class="kw">source</span>(<span class="kw">paste0</span>(dossier.codes, <span class="st">&#39;PlotVideoDyadsGMM.R&#39;</span>)) <span class="co"># general function to plot and animate, using functions above</span></span>
<span id="cb1-32"><a href="data-processing-and-analysis.html#cb1-32"></a><span class="kw">source</span>(<span class="kw">paste0</span>(dossier.codes, <span class="st">&#39;FleetStats-AllGears.r&#39;</span>)) <span class="co"># get fleet stats and network graph</span></span>
<span id="cb1-33"><a href="data-processing-and-analysis.html#cb1-33"></a><span class="kw">source</span>(<span class="kw">paste0</span>(dossier.codes, <span class="st">&#39;stats_clusters.R&#39;</span>)) <span class="co"># get general statistics of groups</span></span>
<span id="cb1-34"><a href="data-processing-and-analysis.html#cb1-34"></a><span class="kw">source</span>(<span class="kw">paste0</span>(dossier.codes, <span class="st">&#39;dyad_classif.R&#39;</span>)) <span class="co"># uses model for pair trawlers to classify the dyads from the other fleets and produce graphs</span></span></code></pre></div>
<p>These functions are <a href="https://github.com/rociojoo/partners-at-sea/tree/master/R">here</a>.</p>
</div>
<div id="gaussian-mixture-modeling" class="section level2">
<h2><span class="header-section-number">2.2</span> Gaussian mixture modeling</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="data-processing-and-analysis.html#cb2-1"></a><span class="co"># load(paste0(dossier.data.outputs, &quot;all_dyads.RData&quot;)) # dyads and metrics</span></span>
<span id="cb2-2"><a href="data-processing-and-analysis.html#cb2-2"></a>dyads &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="dt">file =</span> <span class="kw">paste0</span>(dossier.data.outputs,<span class="st">&quot;all_dyads_vJ.rds&quot;</span>)) </span>
<span id="cb2-3"><a href="data-processing-and-analysis.html#cb2-3"></a><span class="co"># dyads and metrics</span></span>
<span id="cb2-4"><a href="data-processing-and-analysis.html#cb2-4"></a></span>
<span id="cb2-5"><a href="data-processing-and-analysis.html#cb2-5"></a>variables &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Prox&quot;</span>, <span class="st">&quot;DI.theta&quot;</span>, <span class="st">&quot;DI.d&quot;</span>)</span>
<span id="cb2-6"><a href="data-processing-and-analysis.html#cb2-6"></a>gear &lt;-<span class="st"> &quot;all&quot;</span></span>
<span id="cb2-7"><a href="data-processing-and-analysis.html#cb2-7"></a></span>
<span id="cb2-8"><a href="data-processing-and-analysis.html#cb2-8"></a><span class="co"># just PTM and variables for analysis</span></span>
<span id="cb2-9"><a href="data-processing-and-analysis.html#cb2-9"></a>dyads <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">filter</span>(gear<span class="fl">.1</span> <span class="op">==</span><span class="st"> &quot;PTM&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(variables) -&gt;<span class="st"> </span>dta</span>
<span id="cb2-10"><a href="data-processing-and-analysis.html#cb2-10"></a></span>
<span id="cb2-11"><a href="data-processing-and-analysis.html#cb2-11"></a><span class="co">##################### GMM estimation ####################################</span></span>
<span id="cb2-12"><a href="data-processing-and-analysis.html#cb2-12"></a></span>
<span id="cb2-13"><a href="data-processing-and-analysis.html#cb2-13"></a><span class="co"># specifying some parameters for the GMM parameter estimation</span></span>
<span id="cb2-14"><a href="data-processing-and-analysis.html#cb2-14"></a>strat &lt;-</span>
<span id="cb2-15"><a href="data-processing-and-analysis.html#cb2-15"></a><span class="kw">mixmodStrategy</span>(<span class="dt">algo =</span> <span class="st">&quot;EM&quot;</span>, <span class="dt">initMethod =</span> <span class="st">&quot;smallEM&quot;</span>)</span>
<span id="cb2-16"><a href="data-processing-and-analysis.html#cb2-16"></a></span>
<span id="cb2-17"><a href="data-processing-and-analysis.html#cb2-17"></a><span class="co"># Then GMM with the 3 metrics, for 3 clusters</span></span>
<span id="cb2-18"><a href="data-processing-and-analysis.html#cb2-18"></a>N_rep &lt;-<span class="st"> </span><span class="dv">30</span> <span class="co"># number of replicates</span></span>
<span id="cb2-19"><a href="data-processing-and-analysis.html#cb2-19"></a>test &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb2-20"><a href="data-processing-and-analysis.html#cb2-20"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N_rep){</span>
<span id="cb2-21"><a href="data-processing-and-analysis.html#cb2-21"></a>  test[[i]] &lt;-</span>
<span id="cb2-22"><a href="data-processing-and-analysis.html#cb2-22"></a><span class="st">    </span>Rmixmod<span class="op">::</span><span class="kw">mixmodCluster</span>(</span>
<span id="cb2-23"><a href="data-processing-and-analysis.html#cb2-23"></a>      <span class="dt">data =</span> <span class="kw">as.data.frame</span>(dta[, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]),</span>
<span id="cb2-24"><a href="data-processing-and-analysis.html#cb2-24"></a>      <span class="dt">nbCluster =</span> <span class="dv">3</span>,</span>
<span id="cb2-25"><a href="data-processing-and-analysis.html#cb2-25"></a>      <span class="dt">strategy =</span> strat,</span>
<span id="cb2-26"><a href="data-processing-and-analysis.html#cb2-26"></a>      <span class="dt">criterion =</span> <span class="kw">c</span>(<span class="st">&quot;ICL&quot;</span>),</span>
<span id="cb2-27"><a href="data-processing-and-analysis.html#cb2-27"></a>      <span class="dt">models =</span> Rmixmod<span class="op">::</span><span class="kw">mixmodGaussianModel</span>(</span>
<span id="cb2-28"><a href="data-processing-and-analysis.html#cb2-28"></a>        <span class="dt">family =</span> <span class="st">&quot;general&quot;</span>,</span>
<span id="cb2-29"><a href="data-processing-and-analysis.html#cb2-29"></a>        <span class="dt">free.proportions =</span> <span class="ot">TRUE</span>,</span>
<span id="cb2-30"><a href="data-processing-and-analysis.html#cb2-30"></a>        <span class="dt">equal.proportions =</span> <span class="ot">FALSE</span>,</span>
<span id="cb2-31"><a href="data-processing-and-analysis.html#cb2-31"></a>        <span class="dt">listModels =</span></span>
<span id="cb2-32"><a href="data-processing-and-analysis.html#cb2-32"></a>          <span class="kw">c</span>(<span class="st">&quot;Gaussian_pk_Lk_Ck&quot;</span>)</span>
<span id="cb2-33"><a href="data-processing-and-analysis.html#cb2-33"></a>      )</span>
<span id="cb2-34"><a href="data-processing-and-analysis.html#cb2-34"></a>    )</span>
<span id="cb2-35"><a href="data-processing-and-analysis.html#cb2-35"></a>  </span>
<span id="cb2-36"><a href="data-processing-and-analysis.html#cb2-36"></a>}</span>
<span id="cb2-37"><a href="data-processing-and-analysis.html#cb2-37"></a></span>
<span id="cb2-38"><a href="data-processing-and-analysis.html#cb2-38"></a><span class="co"># choosing the best model from the replicates based on ICL</span></span>
<span id="cb2-39"><a href="data-processing-and-analysis.html#cb2-39"></a>BestModel &lt;-</span>
<span id="cb2-40"><a href="data-processing-and-analysis.html#cb2-40"></a>test[[<span class="kw">order</span>(<span class="kw">rapply</span>(test, <span class="cf">function</span>(x)</span>
<span id="cb2-41"><a href="data-processing-and-analysis.html#cb2-41"></a>x<span class="op">@</span>bestResult<span class="op">@</span>criterionValue))[<span class="dv">2</span>]]]</span>
<span id="cb2-42"><a href="data-processing-and-analysis.html#cb2-42"></a></span>
<span id="cb2-43"><a href="data-processing-and-analysis.html#cb2-43"></a><span class="co"># saving the best model</span></span>
<span id="cb2-44"><a href="data-processing-and-analysis.html#cb2-44"></a><span class="kw">saveRDS</span>(</span>
<span id="cb2-45"><a href="data-processing-and-analysis.html#cb2-45"></a>BestModel,</span>
<span id="cb2-46"><a href="data-processing-and-analysis.html#cb2-46"></a><span class="dt">file =</span> <span class="kw">paste0</span>(</span>
<span id="cb2-47"><a href="data-processing-and-analysis.html#cb2-47"></a>dossier.stats.outputs,</span>
<span id="cb2-48"><a href="data-processing-and-analysis.html#cb2-48"></a><span class="st">&#39;BestFreeModel-PTM-&#39;</span>,</span>
<span id="cb2-49"><a href="data-processing-and-analysis.html#cb2-49"></a>gear,</span>
<span id="cb2-50"><a href="data-processing-and-analysis.html#cb2-50"></a><span class="st">&#39;-&#39;</span>,</span>
<span id="cb2-51"><a href="data-processing-and-analysis.html#cb2-51"></a><span class="kw">paste0</span>(variables, <span class="dt">collapse =</span> <span class="st">&#39;-&#39;</span>),</span>
<span id="cb2-52"><a href="data-processing-and-analysis.html#cb2-52"></a><span class="st">&#39;.rds&#39;</span></span>
<span id="cb2-53"><a href="data-processing-and-analysis.html#cb2-53"></a>)</span>
<span id="cb2-54"><a href="data-processing-and-analysis.html#cb2-54"></a>)</span>
<span id="cb2-55"><a href="data-processing-and-analysis.html#cb2-55"></a></span>
<span id="cb2-56"><a href="data-processing-and-analysis.html#cb2-56"></a><span class="co">##################### Extracting output stats ####################################</span></span>
<span id="cb2-57"><a href="data-processing-and-analysis.html#cb2-57"></a></span>
<span id="cb2-58"><a href="data-processing-and-analysis.html#cb2-58"></a><span class="co"># now we are extracting variance values to compare the variance between clusters</span></span>
<span id="cb2-59"><a href="data-processing-and-analysis.html#cb2-59"></a>var_par &lt;-<span class="st"> </span>BestModel<span class="op">@</span>bestResult<span class="op">@</span>parameters<span class="op">@</span>variance</span>
<span id="cb2-60"><a href="data-processing-and-analysis.html#cb2-60"></a><span class="co"># var_par is a list with a number of elements equal to the number of clusters, and each element is a variance matrix for the metrics (for a given cluster)</span></span>
<span id="cb2-61"><a href="data-processing-and-analysis.html#cb2-61"></a><span class="co"># we&#39;ll pay attention to the variances and not covariances, so we&#39;ll use the list to make a matrix where each column is a metric and each row is a cluster, and each element ij is the variance of the metric j in cluster i.</span></span>
<span id="cb2-62"><a href="data-processing-and-analysis.html#cb2-62"></a>variances &lt;-</span>
<span id="cb2-63"><a href="data-processing-and-analysis.html#cb2-63"></a><span class="kw">t</span>(<span class="kw">sapply</span>(BestModel<span class="op">@</span>bestResult<span class="op">@</span>parameters<span class="op">@</span>variance, <span class="cf">function</span>(mat_) {</span>
<span id="cb2-64"><a href="data-processing-and-analysis.html#cb2-64"></a><span class="kw">diag</span>(mat_)</span>
<span id="cb2-65"><a href="data-processing-and-analysis.html#cb2-65"></a>}))</span>
<span id="cb2-66"><a href="data-processing-and-analysis.html#cb2-66"></a><span class="co"># we then get the minimum variance per metric accross clusters. And, now that I think about it, this is biased by the fact that not all variables are in the same range. DI.theta goes from -1 to 1.</span></span>
<span id="cb2-67"><a href="data-processing-and-analysis.html#cb2-67"></a>minimal_var &lt;-<span class="st"> </span><span class="kw">apply</span>(variances, <span class="dv">2</span>, min)</span>
<span id="cb2-68"><a href="data-processing-and-analysis.html#cb2-68"></a><span class="co"># now, how much is variance of each metric in each cluster is higher than the minimum variance of each metric throughout clusters?</span></span>
<span id="cb2-69"><a href="data-processing-and-analysis.html#cb2-69"></a>ratio_var &lt;-<span class="st"> </span><span class="kw">sweep</span>(variances, <span class="dv">2</span>, <span class="dt">STATS =</span> minimal_var, <span class="dt">FUN =</span> <span class="st">&#39;/&#39;</span>)</span>
<span id="cb2-70"><a href="data-processing-and-analysis.html#cb2-70"></a><span class="co"># another form of comparison can be done by using the variances (not covariances) and means to calculate the coefficients of variation</span></span>
<span id="cb2-71"><a href="data-processing-and-analysis.html#cb2-71"></a>cv &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">t</span>(</span>
<span id="cb2-72"><a href="data-processing-and-analysis.html#cb2-72"></a><span class="kw">sapply</span>(BestModel<span class="op">@</span>bestResult<span class="op">@</span>parameters<span class="op">@</span>variance,</span>
<span id="cb2-73"><a href="data-processing-and-analysis.html#cb2-73"></a><span class="cf">function</span>(mat_) {</span>
<span id="cb2-74"><a href="data-processing-and-analysis.html#cb2-74"></a><span class="kw">diag</span>(mat_)</span>
<span id="cb2-75"><a href="data-processing-and-analysis.html#cb2-75"></a>})</span>
<span id="cb2-76"><a href="data-processing-and-analysis.html#cb2-76"></a>)) <span class="op">/</span><span class="st">  </span>BestModel<span class="op">@</span>bestResult<span class="op">@</span>parameters<span class="op">@</span>mean</span>
<span id="cb2-77"><a href="data-processing-and-analysis.html#cb2-77"></a></span>
<span id="cb2-78"><a href="data-processing-and-analysis.html#cb2-78"></a><span class="co"># saving these results</span></span>
<span id="cb2-79"><a href="data-processing-and-analysis.html#cb2-79"></a>cluster.file =<span class="st"> </span><span class="kw">paste0</span>(</span>
<span id="cb2-80"><a href="data-processing-and-analysis.html#cb2-80"></a>dossier.stats.outputs,</span>
<span id="cb2-81"><a href="data-processing-and-analysis.html#cb2-81"></a><span class="st">&#39;cluster_var_PTM_&#39;</span>,</span>
<span id="cb2-82"><a href="data-processing-and-analysis.html#cb2-82"></a>gear,</span>
<span id="cb2-83"><a href="data-processing-and-analysis.html#cb2-83"></a><span class="st">&#39;-&#39;</span>,</span>
<span id="cb2-84"><a href="data-processing-and-analysis.html#cb2-84"></a><span class="kw">paste</span>(<span class="kw">str_replace_all</span>(variables, <span class="st">&quot;[[:punct:]]&quot;</span>, <span class="st">&quot;&quot;</span>), <span class="dt">collapse =</span> <span class="st">&#39;-&#39;</span>),</span>
<span id="cb2-85"><a href="data-processing-and-analysis.html#cb2-85"></a><span class="st">&#39;.txt&#39;</span></span>
<span id="cb2-86"><a href="data-processing-and-analysis.html#cb2-86"></a>)</span>
<span id="cb2-87"><a href="data-processing-and-analysis.html#cb2-87"></a><span class="kw">sink</span>(cluster.file)</span>
<span id="cb2-88"><a href="data-processing-and-analysis.html#cb2-88"></a><span class="kw">cat</span>(<span class="st">&quot;Number of clusters: &quot;</span>, BestModel<span class="op">@</span>bestResult<span class="op">@</span>nbCluster, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2-89"><a href="data-processing-and-analysis.html#cb2-89"></a><span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2-90"><a href="data-processing-and-analysis.html#cb2-90"></a><span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2-91"><a href="data-processing-and-analysis.html#cb2-91"></a><span class="kw">cat</span>(<span class="st">&quot;Metric variances: &quot;</span>, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2-92"><a href="data-processing-and-analysis.html#cb2-92"></a><span class="kw">print</span>(variances)</span>
<span id="cb2-93"><a href="data-processing-and-analysis.html#cb2-93"></a><span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2-94"><a href="data-processing-and-analysis.html#cb2-94"></a><span class="kw">cat</span>(<span class="st">&quot;Ratios: &quot;</span>, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2-95"><a href="data-processing-and-analysis.html#cb2-95"></a><span class="kw">print</span>(ratio_var)</span>
<span id="cb2-96"><a href="data-processing-and-analysis.html#cb2-96"></a><span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2-97"><a href="data-processing-and-analysis.html#cb2-97"></a><span class="kw">cat</span>(<span class="st">&quot;CV: &quot;</span>, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2-98"><a href="data-processing-and-analysis.html#cb2-98"></a><span class="kw">print</span>(cv)</span>
<span id="cb2-99"><a href="data-processing-and-analysis.html#cb2-99"></a><span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2-100"><a href="data-processing-and-analysis.html#cb2-100"></a><span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2-101"><a href="data-processing-and-analysis.html#cb2-101"></a><span class="kw">sink</span>()</span>
<span id="cb2-102"><a href="data-processing-and-analysis.html#cb2-102"></a></span>
<span id="cb2-103"><a href="data-processing-and-analysis.html#cb2-103"></a><span class="co"># adding the cluster classification and associated probability to the PTM df</span></span>
<span id="cb2-104"><a href="data-processing-and-analysis.html#cb2-104"></a>dta <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(</span>
<span id="cb2-105"><a href="data-processing-and-analysis.html#cb2-105"></a><span class="dt">clust_prox =</span> <span class="kw">factor</span>(BestModel<span class="op">@</span>bestResult<span class="op">@</span>partition),</span>
<span id="cb2-106"><a href="data-processing-and-analysis.html#cb2-106"></a><span class="dt">p_cluster =</span> <span class="kw">apply</span>(BestModel<span class="op">@</span>bestResult<span class="op">@</span>proba, <span class="dv">1</span>, max)</span>
<span id="cb2-107"><a href="data-processing-and-analysis.html#cb2-107"></a>) -&gt;<span class="st"> </span>dta</span>
<span id="cb2-108"><a href="data-processing-and-analysis.html#cb2-108"></a></span>
<span id="cb2-109"><a href="data-processing-and-analysis.html#cb2-109"></a><span class="co"># overlapping index</span></span>
<span id="cb2-110"><a href="data-processing-and-analysis.html#cb2-110"></a>mean_variance &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb2-111"><a href="data-processing-and-analysis.html#cb2-111"></a>mean_variance<span class="op">$</span>means &lt;-<span class="st"> </span>BestModel<span class="op">@</span>bestResult<span class="op">@</span>parameters<span class="op">@</span>mean</span>
<span id="cb2-112"><a href="data-processing-and-analysis.html#cb2-112"></a></span>
<span id="cb2-113"><a href="data-processing-and-analysis.html#cb2-113"></a>mean_variance<span class="op">$</span>variance &lt;-<span class="st"> </span>BestModel<span class="op">@</span>bestResult<span class="op">@</span>parameters<span class="op">@</span>variance</span>
<span id="cb2-114"><a href="data-processing-and-analysis.html#cb2-114"></a></span>
<span id="cb2-115"><a href="data-processing-and-analysis.html#cb2-115"></a>means &lt;-<span class="st"> </span>mean_variance<span class="op">$</span>means</span>
<span id="cb2-116"><a href="data-processing-and-analysis.html#cb2-116"></a>variances &lt;-<span class="st"> </span>mean_variance<span class="op">$</span>variance</span>
<span id="cb2-117"><a href="data-processing-and-analysis.html#cb2-117"></a>delta &lt;-<span class="st"> </span><span class="fl">0.025</span> <span class="co"># pas de discrétisation des lois gaussiennes</span></span>
<span id="cb2-118"><a href="data-processing-and-analysis.html#cb2-118"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">2</span>, delta) <span class="co"># discrétisation de l&#39;[] de fluctuation +/- 1</span></span>
<span id="cb2-119"><a href="data-processing-and-analysis.html#cb2-119"></a>y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">2</span>, delta) <span class="co"># discrétisation de l&#39;[] de fluctuation +/- 1</span></span>
<span id="cb2-120"><a href="data-processing-and-analysis.html#cb2-120"></a>z &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">2</span>, delta) <span class="co"># discrétisation de l&#39;[] de fluctuation +/- 1</span></span>
<span id="cb2-121"><a href="data-processing-and-analysis.html#cb2-121"></a>grid &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(x, y, z)</span>
<span id="cb2-122"><a href="data-processing-and-analysis.html#cb2-122"></a>gaussian.overlap.trivar &lt;-</span>
<span id="cb2-123"><a href="data-processing-and-analysis.html#cb2-123"></a><span class="kw">array</span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">3</span>), <span class="dt">dimnames =</span> <span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;c1&quot;</span>, <span class="st">&quot;c2&quot;</span>, <span class="st">&quot;c3&quot;</span>), <span class="kw">c</span>(<span class="st">&quot;c1&quot;</span>, <span class="st">&quot;c2&quot;</span>, <span class="st">&quot;c3&quot;</span>)))</span>
<span id="cb2-124"><a href="data-processing-and-analysis.html#cb2-124"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>) {</span>
<span id="cb2-125"><a href="data-processing-and-analysis.html#cb2-125"></a><span class="cf">for</span> (j <span class="cf">in</span> (i <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span><span class="dv">3</span>) {</span>
<span id="cb2-126"><a href="data-processing-and-analysis.html#cb2-126"></a><span class="co">#i &lt;- 3 ; j &lt;- 2</span></span>
<span id="cb2-127"><a href="data-processing-and-analysis.html#cb2-127"></a>p1 &lt;-</span>
<span id="cb2-128"><a href="data-processing-and-analysis.html#cb2-128"></a><span class="kw">dmvnorm</span>(<span class="dt">x =</span> grid,</span>
<span id="cb2-129"><a href="data-processing-and-analysis.html#cb2-129"></a><span class="dt">mean =</span> <span class="kw">t</span>(means[i, ]),</span>
<span id="cb2-130"><a href="data-processing-and-analysis.html#cb2-130"></a><span class="dt">sigma =</span> variances[[i]]) <span class="co">### tri-Gaussian for cluster i</span></span>
<span id="cb2-131"><a href="data-processing-and-analysis.html#cb2-131"></a>p2 &lt;-</span>
<span id="cb2-132"><a href="data-processing-and-analysis.html#cb2-132"></a><span class="kw">dmvnorm</span>(<span class="dt">x =</span> grid,</span>
<span id="cb2-133"><a href="data-processing-and-analysis.html#cb2-133"></a><span class="dt">mean =</span> <span class="kw">t</span>(means[j, ]),</span>
<span id="cb2-134"><a href="data-processing-and-analysis.html#cb2-134"></a><span class="dt">sigma =</span> variances[[j]]) <span class="co">### tri-Gaussian for cluster j</span></span>
<span id="cb2-135"><a href="data-processing-and-analysis.html#cb2-135"></a>gaussian.overlap.trivar[i, j] &lt;-</span>
<span id="cb2-136"><a href="data-processing-and-analysis.html#cb2-136"></a><span class="kw">sum</span>((p1 <span class="op">&lt;</span><span class="st"> </span>p2) <span class="op">*</span><span class="st"> </span>p1 <span class="op">+</span><span class="st"> </span>(p2 <span class="op">&lt;</span><span class="st"> </span>p1) <span class="op">*</span><span class="st"> </span>p2) <span class="op">*</span><span class="st"> </span>delta <span class="op">^</span><span class="st"> </span><span class="dv">3</span></span>
<span id="cb2-137"><a href="data-processing-and-analysis.html#cb2-137"></a>}</span>
<span id="cb2-138"><a href="data-processing-and-analysis.html#cb2-138"></a>}</span>
<span id="cb2-139"><a href="data-processing-and-analysis.html#cb2-139"></a><span class="kw">print</span>(<span class="st">&quot;overlapping index&quot;</span>)</span>
<span id="cb2-140"><a href="data-processing-and-analysis.html#cb2-140"></a><span class="kw">print</span>(gaussian.overlap.trivar)</span>
<span id="cb2-141"><a href="data-processing-and-analysis.html#cb2-141"></a></span>
<span id="cb2-142"><a href="data-processing-and-analysis.html#cb2-142"></a><span class="co">##################### Ordering clusters ####################################</span></span>
<span id="cb2-143"><a href="data-processing-and-analysis.html#cb2-143"></a></span>
<span id="cb2-144"><a href="data-processing-and-analysis.html#cb2-144"></a><span class="co"># Now, we need to find a way to automatically order the clusters by degree of joint movement.</span></span>
<span id="cb2-145"><a href="data-processing-and-analysis.html#cb2-145"></a><span class="co"># For that, we will use the mean of the scaled and centered variables</span></span>
<span id="cb2-146"><a href="data-processing-and-analysis.html#cb2-146"></a>mean_metrics &lt;-<span class="st"> </span>dta <span class="op">%&gt;%</span></span>
<span id="cb2-147"><a href="data-processing-and-analysis.html#cb2-147"></a><span class="kw">mutate</span>(</span>
<span id="cb2-148"><a href="data-processing-and-analysis.html#cb2-148"></a><span class="dt">prox_z =</span> <span class="kw">scale</span>(Prox, <span class="dt">center =</span> <span class="ot">TRUE</span>, <span class="dt">scale =</span> <span class="ot">TRUE</span>),</span>
<span id="cb2-149"><a href="data-processing-and-analysis.html#cb2-149"></a><span class="dt">di_theta_z =</span> <span class="kw">scale</span>(DI.theta, <span class="dt">center =</span> <span class="ot">TRUE</span>, <span class="dt">scale =</span> <span class="ot">TRUE</span>),</span>
<span id="cb2-150"><a href="data-processing-and-analysis.html#cb2-150"></a><span class="dt">di_d_z =</span> <span class="kw">scale</span>(DI.d, <span class="dt">center =</span> <span class="ot">TRUE</span>, <span class="dt">scale =</span> <span class="ot">TRUE</span>)</span>
<span id="cb2-151"><a href="data-processing-and-analysis.html#cb2-151"></a>) <span class="op">%&gt;%</span></span>
<span id="cb2-152"><a href="data-processing-and-analysis.html#cb2-152"></a><span class="kw">group_by</span>(clust_prox) <span class="op">%&gt;%</span></span>
<span id="cb2-153"><a href="data-processing-and-analysis.html#cb2-153"></a><span class="kw">summarise</span>(</span>
<span id="cb2-154"><a href="data-processing-and-analysis.html#cb2-154"></a><span class="dt">m_prox_z =</span> <span class="kw">mean</span>(prox_z),</span>
<span id="cb2-155"><a href="data-processing-and-analysis.html#cb2-155"></a><span class="dt">m_di_theta_z =</span> <span class="kw">mean</span>(di_theta_z),</span>
<span id="cb2-156"><a href="data-processing-and-analysis.html#cb2-156"></a><span class="dt">m_di_d_z =</span> <span class="kw">mean</span>(di_d_z)</span>
<span id="cb2-157"><a href="data-processing-and-analysis.html#cb2-157"></a>)</span>
<span id="cb2-158"><a href="data-processing-and-analysis.html#cb2-158"></a></span>
<span id="cb2-159"><a href="data-processing-and-analysis.html#cb2-159"></a>order_clust &lt;-</span>
<span id="cb2-160"><a href="data-processing-and-analysis.html#cb2-160"></a><span class="st">  </span><span class="kw">order</span>(<span class="kw">apply</span>(mean_metrics[, <span class="dv">2</span><span class="op">:</span><span class="dv">4</span>], <span class="dv">1</span>, <span class="dt">FUN =</span> <span class="st">&quot;mean&quot;</span>), <span class="dt">decreasing =</span> <span class="ot">TRUE</span>)</span>
<span id="cb2-161"><a href="data-processing-and-analysis.html#cb2-161"></a>  </span>
<span id="cb2-162"><a href="data-processing-and-analysis.html#cb2-162"></a>  <span class="co"># once we get the order in which clusters should be, we change the label of clusters so that 1 corresponds to high joint movement... and so on</span></span>
<span id="cb2-163"><a href="data-processing-and-analysis.html#cb2-163"></a>  <span class="co"># the clust_prox column was a factor so let&#39;s first transform it into numeric</span></span>
<span id="cb2-164"><a href="data-processing-and-analysis.html#cb2-164"></a>  dta<span class="op">$</span>clust_prox &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">as.character</span>(dta<span class="op">$</span>clust_prox))</span>
<span id="cb2-165"><a href="data-processing-and-analysis.html#cb2-165"></a>  </span>
<span id="cb2-166"><a href="data-processing-and-analysis.html#cb2-166"></a>  <span class="co"># stock the old label into a vector so that we change things around in this vector</span></span>
<span id="cb2-167"><a href="data-processing-and-analysis.html#cb2-167"></a>  new_order_vector &lt;-<span class="st"> </span>dta<span class="op">$</span>clust_prox</span>
<span id="cb2-168"><a href="data-processing-and-analysis.html#cb2-168"></a>  </span>
<span id="cb2-169"><a href="data-processing-and-analysis.html#cb2-169"></a>  <span class="co"># I could have done this one before: stock the number of clusters in an object</span></span>
<span id="cb2-170"><a href="data-processing-and-analysis.html#cb2-170"></a>  k &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(new_order_vector))</span>
<span id="cb2-171"><a href="data-processing-and-analysis.html#cb2-171"></a>  <span class="co"># for each &#39;new label&#39;, we get its corresponding old label, then search in the old column for those observations and change them for the new label in the new vector</span></span>
<span id="cb2-172"><a href="data-processing-and-analysis.html#cb2-172"></a>  <span class="cf">for</span> (cl <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k) {</span>
<span id="cb2-173"><a href="data-processing-and-analysis.html#cb2-173"></a>  new_order_vector[<span class="kw">which</span>(dta<span class="op">$</span>clust_prox <span class="op">==</span><span class="st"> </span>order_clust[cl])] &lt;-<span class="st"> </span>cl</span>
<span id="cb2-174"><a href="data-processing-and-analysis.html#cb2-174"></a>  }</span>
<span id="cb2-175"><a href="data-processing-and-analysis.html#cb2-175"></a>  <span class="co"># then add a new column to the df with the new order</span></span>
<span id="cb2-176"><a href="data-processing-and-analysis.html#cb2-176"></a>  dta<span class="op">$</span>clust_new_order &lt;-<span class="st"> </span>new_order_vector</span>
<span id="cb2-177"><a href="data-processing-and-analysis.html#cb2-177"></a>  <span class="co"># and add a column that is a factor of that</span></span>
<span id="cb2-178"><a href="data-processing-and-analysis.html#cb2-178"></a>  dta<span class="op">$</span>group &lt;-<span class="st"> </span><span class="kw">as.factor</span>(dta<span class="op">$</span>clust_new_order)</span>
<span id="cb2-179"><a href="data-processing-and-analysis.html#cb2-179"></a>  </span>
<span id="cb2-180"><a href="data-processing-and-analysis.html#cb2-180"></a><span class="co">##################### Plots and stats ####################################</span></span>
<span id="cb2-181"><a href="data-processing-and-analysis.html#cb2-181"></a>  </span>
<span id="cb2-182"><a href="data-processing-and-analysis.html#cb2-182"></a>  <span class="co"># Now let&#39;s do some plots with the new order and save them as pdf (for resolution and vectorial graphics) and png (for quick views)</span></span>
<span id="cb2-183"><a href="data-processing-and-analysis.html#cb2-183"></a>  <span class="co"># I&#39;m using viridis color palette since it should be colorblind friendly</span></span>
<span id="cb2-184"><a href="data-processing-and-analysis.html#cb2-184"></a>  <span class="co"># First plot: first metric vs. second metric</span></span>
<span id="cb2-185"><a href="data-processing-and-analysis.html#cb2-185"></a>  dta <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> dta[, <span class="dv">1</span>], <span class="dt">y =</span> dta[, <span class="dv">2</span>], <span class="dt">col =</span> group)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&#39;Prox&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&#39;DItheta&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_colour_viridis_d</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()</span>
<span id="cb2-186"><a href="data-processing-and-analysis.html#cb2-186"></a>  <span class="kw">ggsave</span>(</span>
<span id="cb2-187"><a href="data-processing-and-analysis.html#cb2-187"></a>  <span class="kw">paste0</span>(</span>
<span id="cb2-188"><a href="data-processing-and-analysis.html#cb2-188"></a>  dossier.stats.outputs,</span>
<span id="cb2-189"><a href="data-processing-and-analysis.html#cb2-189"></a>  <span class="st">&quot;clustFree_Prox_DItheta_PTM_&quot;</span>,</span>
<span id="cb2-190"><a href="data-processing-and-analysis.html#cb2-190"></a>  gear,</span>
<span id="cb2-191"><a href="data-processing-and-analysis.html#cb2-191"></a>  <span class="st">&quot;_ordered.pdf&quot;</span></span>
<span id="cb2-192"><a href="data-processing-and-analysis.html#cb2-192"></a>  )</span>
<span id="cb2-193"><a href="data-processing-and-analysis.html#cb2-193"></a>  )</span>
<span id="cb2-194"><a href="data-processing-and-analysis.html#cb2-194"></a>  <span class="kw">ggsave</span>(</span>
<span id="cb2-195"><a href="data-processing-and-analysis.html#cb2-195"></a>  <span class="kw">paste0</span>(</span>
<span id="cb2-196"><a href="data-processing-and-analysis.html#cb2-196"></a>  dossier.stats.outputs,</span>
<span id="cb2-197"><a href="data-processing-and-analysis.html#cb2-197"></a>  <span class="st">&quot;clustFree_Prox_DItheta_PTM_&quot;</span>,</span>
<span id="cb2-198"><a href="data-processing-and-analysis.html#cb2-198"></a>  gear,</span>
<span id="cb2-199"><a href="data-processing-and-analysis.html#cb2-199"></a>  <span class="st">&quot;_ordered.png&quot;</span></span>
<span id="cb2-200"><a href="data-processing-and-analysis.html#cb2-200"></a>  )</span>
<span id="cb2-201"><a href="data-processing-and-analysis.html#cb2-201"></a>  )</span>
<span id="cb2-202"><a href="data-processing-and-analysis.html#cb2-202"></a>  </span>
<span id="cb2-203"><a href="data-processing-and-analysis.html#cb2-203"></a>  <span class="co"># First metric vs. third metric</span></span>
<span id="cb2-204"><a href="data-processing-and-analysis.html#cb2-204"></a>  dta <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> dta[, <span class="dv">1</span>], <span class="dt">y =</span> dta[, <span class="dv">3</span>], <span class="dt">col =</span> group)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&#39;Prox&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&#39;DId&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_colour_viridis_d</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()</span>
<span id="cb2-205"><a href="data-processing-and-analysis.html#cb2-205"></a>  <span class="kw">ggsave</span>(<span class="kw">paste0</span>(</span>
<span id="cb2-206"><a href="data-processing-and-analysis.html#cb2-206"></a>  dossier.stats.outputs,</span>
<span id="cb2-207"><a href="data-processing-and-analysis.html#cb2-207"></a>  <span class="st">&quot;clustFree_Prox_DId_PTM_&quot;</span>,</span>
<span id="cb2-208"><a href="data-processing-and-analysis.html#cb2-208"></a>  gear,</span>
<span id="cb2-209"><a href="data-processing-and-analysis.html#cb2-209"></a>  <span class="st">&quot;_ordered.pdf&quot;</span></span>
<span id="cb2-210"><a href="data-processing-and-analysis.html#cb2-210"></a>  ))</span>
<span id="cb2-211"><a href="data-processing-and-analysis.html#cb2-211"></a>  <span class="kw">ggsave</span>(<span class="kw">paste0</span>(</span>
<span id="cb2-212"><a href="data-processing-and-analysis.html#cb2-212"></a>  dossier.stats.outputs,</span>
<span id="cb2-213"><a href="data-processing-and-analysis.html#cb2-213"></a>  <span class="st">&quot;clustFree_Prox_DId_PTM_&quot;</span>,</span>
<span id="cb2-214"><a href="data-processing-and-analysis.html#cb2-214"></a>  gear,</span>
<span id="cb2-215"><a href="data-processing-and-analysis.html#cb2-215"></a>  <span class="st">&quot;_ordered.png&quot;</span></span>
<span id="cb2-216"><a href="data-processing-and-analysis.html#cb2-216"></a>  ))</span>
<span id="cb2-217"><a href="data-processing-and-analysis.html#cb2-217"></a>  </span>
<span id="cb2-218"><a href="data-processing-and-analysis.html#cb2-218"></a>  <span class="co"># Now plotting distributions of probabilities per cluster</span></span>
<span id="cb2-219"><a href="data-processing-and-analysis.html#cb2-219"></a>  </span>
<span id="cb2-220"><a href="data-processing-and-analysis.html#cb2-220"></a>  <span class="co"># median posterior probability per cluster</span></span>
<span id="cb2-221"><a href="data-processing-and-analysis.html#cb2-221"></a>  dta <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(group) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="kw">median</span>(p_cluster)) </span>
<span id="cb2-222"><a href="data-processing-and-analysis.html#cb2-222"></a>  </span>
<span id="cb2-223"><a href="data-processing-and-analysis.html#cb2-223"></a>  <span class="kw">ggplot</span>(<span class="dt">data =</span> dta, <span class="kw">aes</span> (<span class="dt">x =</span> group, <span class="dt">y =</span> p_cluster, <span class="dt">fill =</span> group)) <span class="op">+</span></span>
<span id="cb2-224"><a href="data-processing-and-analysis.html#cb2-224"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb2-225"><a href="data-processing-and-analysis.html#cb2-225"></a><span class="st">  </span><span class="kw">scale_fill_viridis</span>(<span class="dt">discrete =</span> <span class="ot">TRUE</span>)  <span class="op">+</span></span>
<span id="cb2-226"><a href="data-processing-and-analysis.html#cb2-226"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb2-227"><a href="data-processing-and-analysis.html#cb2-227"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&#39;&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span></span>
<span id="cb2-228"><a href="data-processing-and-analysis.html#cb2-228"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">18</span>))</span>
<span id="cb2-229"><a href="data-processing-and-analysis.html#cb2-229"></a>  <span class="kw">ggsave</span>(<span class="kw">paste0</span>(</span>
<span id="cb2-230"><a href="data-processing-and-analysis.html#cb2-230"></a>  dossier.stats.outputs,</span>
<span id="cb2-231"><a href="data-processing-and-analysis.html#cb2-231"></a>  <span class="st">&quot;clustFree_proba_PTM_&quot;</span>,</span>
<span id="cb2-232"><a href="data-processing-and-analysis.html#cb2-232"></a>  gear,</span>
<span id="cb2-233"><a href="data-processing-and-analysis.html#cb2-233"></a>  <span class="st">&quot;_ordered.pdf&quot;</span></span>
<span id="cb2-234"><a href="data-processing-and-analysis.html#cb2-234"></a>  ))</span>
<span id="cb2-235"><a href="data-processing-and-analysis.html#cb2-235"></a>  <span class="kw">ggsave</span>(<span class="kw">paste0</span>(</span>
<span id="cb2-236"><a href="data-processing-and-analysis.html#cb2-236"></a>  dossier.stats.outputs,</span>
<span id="cb2-237"><a href="data-processing-and-analysis.html#cb2-237"></a>  <span class="st">&quot;clustFree_proba_PTM_&quot;</span>,</span>
<span id="cb2-238"><a href="data-processing-and-analysis.html#cb2-238"></a>  gear,</span>
<span id="cb2-239"><a href="data-processing-and-analysis.html#cb2-239"></a>  <span class="st">&quot;_ordered.png&quot;</span></span>
<span id="cb2-240"><a href="data-processing-and-analysis.html#cb2-240"></a>  ))</span>
<span id="cb2-241"><a href="data-processing-and-analysis.html#cb2-241"></a>  </span>
<span id="cb2-242"><a href="data-processing-and-analysis.html#cb2-242"></a>  <span class="co"># calculating the percentage of PTM dyads in each cluster and then saving the information</span></span>
<span id="cb2-243"><a href="data-processing-and-analysis.html#cb2-243"></a>  perc_table &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">prop.table</span>(<span class="kw">table</span>(dta<span class="op">$</span>group)) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb2-244"><a href="data-processing-and-analysis.html#cb2-244"></a>  </span>
<span id="cb2-245"><a href="data-processing-and-analysis.html#cb2-245"></a>  <span class="kw">sink</span>(cluster.file, <span class="dt">append =</span> <span class="ot">TRUE</span>)</span>
<span id="cb2-246"><a href="data-processing-and-analysis.html#cb2-246"></a>  <span class="kw">cat</span>(<span class="st">&quot;Order of old labels: &quot;</span>, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2-247"><a href="data-processing-and-analysis.html#cb2-247"></a>  <span class="kw">print</span>(order_clust)</span>
<span id="cb2-248"><a href="data-processing-and-analysis.html#cb2-248"></a>  <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2-249"><a href="data-processing-and-analysis.html#cb2-249"></a>  <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2-250"><a href="data-processing-and-analysis.html#cb2-250"></a>  <span class="kw">cat</span>(<span class="st">&quot;Percentage of dyads in each ordered cluster: &quot;</span>, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2-251"><a href="data-processing-and-analysis.html#cb2-251"></a>  <span class="kw">print</span>(perc_table)</span>
<span id="cb2-252"><a href="data-processing-and-analysis.html#cb2-252"></a>  <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2-253"><a href="data-processing-and-analysis.html#cb2-253"></a>  <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2-254"><a href="data-processing-and-analysis.html#cb2-254"></a>  <span class="kw">sink</span>()</span>
<span id="cb2-255"><a href="data-processing-and-analysis.html#cb2-255"></a>  </span>
<span id="cb2-256"><a href="data-processing-and-analysis.html#cb2-256"></a>  <span class="co"># Now I want to know what the distribution of each metric looks like in each cluster. I&#39;ll do that through violin plots. For that, I&#39;ll need to work on the format of the df to plot</span></span>
<span id="cb2-257"><a href="data-processing-and-analysis.html#cb2-257"></a>  <span class="co"># Selecting just the columns of interest</span></span>
<span id="cb2-258"><a href="data-processing-and-analysis.html#cb2-258"></a>  dta_facto  &lt;-<span class="st"> </span>dta[, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">7</span>)]</span>
<span id="cb2-259"><a href="data-processing-and-analysis.html#cb2-259"></a>  <span class="co"># Gathering into more rows and less columns</span></span>
<span id="cb2-260"><a href="data-processing-and-analysis.html#cb2-260"></a>  dta_gather &lt;-<span class="st"> </span>dta_facto <span class="op">%&gt;%</span></span>
<span id="cb2-261"><a href="data-processing-and-analysis.html#cb2-261"></a><span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> metric, <span class="dt">value =</span> value,<span class="op">-</span>clust_prox,<span class="op">-</span>group)</span>
<span id="cb2-262"><a href="data-processing-and-analysis.html#cb2-262"></a>  <span class="co"># Transforming the new metric column into a factor with levels ordered based on the contribution of each metric to the first principal component</span></span>
<span id="cb2-263"><a href="data-processing-and-analysis.html#cb2-263"></a>  dta_gather<span class="op">$</span>metric &lt;-</span>
<span id="cb2-264"><a href="data-processing-and-analysis.html#cb2-264"></a><span class="st">  </span><span class="kw">factor</span>(dta_gather<span class="op">$</span>metric, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Prox&quot;</span>, <span class="st">&quot;DI.theta&quot;</span>, <span class="st">&quot;DI.d&quot;</span>))</span>
<span id="cb2-265"><a href="data-processing-and-analysis.html#cb2-265"></a>  <span class="co">#names(weight_var)[order(weight_var,</span></span>
<span id="cb2-266"><a href="data-processing-and-analysis.html#cb2-266"></a>  <span class="co"># decreasing = TRUE)])</span></span>
<span id="cb2-267"><a href="data-processing-and-analysis.html#cb2-267"></a>  </span>
<span id="cb2-268"><a href="data-processing-and-analysis.html#cb2-268"></a>  <span class="co"># histograms</span></span>
<span id="cb2-269"><a href="data-processing-and-analysis.html#cb2-269"></a>  <span class="kw">ggplot</span>(<span class="dt">data =</span> dta_gather, <span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">color =</span> group)) <span class="op">+</span></span>
<span id="cb2-270"><a href="data-processing-and-analysis.html#cb2-270"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="op">+</span></span>
<span id="cb2-271"><a href="data-processing-and-analysis.html#cb2-271"></a><span class="st">  </span><span class="co"># geom_density(alpha=0.6)+</span></span>
<span id="cb2-272"><a href="data-processing-and-analysis.html#cb2-272"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="dt">facets =</span> <span class="kw">vars</span>(metric), <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="op">+</span></span>
<span id="cb2-273"><a href="data-processing-and-analysis.html#cb2-273"></a><span class="st">  </span><span class="kw">scale_color_viridis</span>(<span class="dt">discrete =</span> <span class="ot">TRUE</span>) <span class="op">+</span></span>
<span id="cb2-274"><a href="data-processing-and-analysis.html#cb2-274"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb2-275"><a href="data-processing-and-analysis.html#cb2-275"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&#39;&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span></span>
<span id="cb2-276"><a href="data-processing-and-analysis.html#cb2-276"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>))</span>
<span id="cb2-277"><a href="data-processing-and-analysis.html#cb2-277"></a>  <span class="kw">ggsave</span>(</span>
<span id="cb2-278"><a href="data-processing-and-analysis.html#cb2-278"></a>  <span class="kw">paste0</span>(</span>
<span id="cb2-279"><a href="data-processing-and-analysis.html#cb2-279"></a>  dossier.stats.outputs,</span>
<span id="cb2-280"><a href="data-processing-and-analysis.html#cb2-280"></a>  <span class="st">&quot;clustFree_MetricsHist_PTM_&quot;</span>,</span>
<span id="cb2-281"><a href="data-processing-and-analysis.html#cb2-281"></a>  gear,</span>
<span id="cb2-282"><a href="data-processing-and-analysis.html#cb2-282"></a>  <span class="st">&quot;_ordered.pdf&quot;</span></span>
<span id="cb2-283"><a href="data-processing-and-analysis.html#cb2-283"></a>  ),</span>
<span id="cb2-284"><a href="data-processing-and-analysis.html#cb2-284"></a>  <span class="dt">width =</span> <span class="dv">8</span></span>
<span id="cb2-285"><a href="data-processing-and-analysis.html#cb2-285"></a>  )</span>
<span id="cb2-286"><a href="data-processing-and-analysis.html#cb2-286"></a>  <span class="kw">ggsave</span>(</span>
<span id="cb2-287"><a href="data-processing-and-analysis.html#cb2-287"></a>  <span class="kw">paste0</span>(</span>
<span id="cb2-288"><a href="data-processing-and-analysis.html#cb2-288"></a>  dossier.stats.outputs,</span>
<span id="cb2-289"><a href="data-processing-and-analysis.html#cb2-289"></a>  <span class="st">&quot;clustFree_MetricsHist_PTM_&quot;</span>,</span>
<span id="cb2-290"><a href="data-processing-and-analysis.html#cb2-290"></a>  gear,</span>
<span id="cb2-291"><a href="data-processing-and-analysis.html#cb2-291"></a>  <span class="st">&quot;_ordered.png&quot;</span></span>
<span id="cb2-292"><a href="data-processing-and-analysis.html#cb2-292"></a>  ),</span>
<span id="cb2-293"><a href="data-processing-and-analysis.html#cb2-293"></a>  <span class="dt">width =</span> <span class="dv">8</span></span>
<span id="cb2-294"><a href="data-processing-and-analysis.html#cb2-294"></a>  )</span>
<span id="cb2-295"><a href="data-processing-and-analysis.html#cb2-295"></a>  </span>
<span id="cb2-296"><a href="data-processing-and-analysis.html#cb2-296"></a><span class="co">## Here we&#39;ll be computing stats about the number of dyads, couples, vessels, etc., in total and each cluster</span></span>
<span id="cb2-297"><a href="data-processing-and-analysis.html#cb2-297"></a></span>
<span id="cb2-298"><a href="data-processing-and-analysis.html#cb2-298"></a><span class="co"># First, we&#39;ll save a df with everything we could care about for PTM dyads</span></span>
<span id="cb2-299"><a href="data-processing-and-analysis.html#cb2-299"></a>dyads_cluster &lt;-<span class="st"> </span>dyads <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(gear<span class="fl">.1</span> <span class="op">==</span><span class="st"> &quot;PTM&quot;</span>)</span>
<span id="cb2-300"><a href="data-processing-and-analysis.html#cb2-300"></a>dyads_cluster &lt;-</span>
<span id="cb2-301"><a href="data-processing-and-analysis.html#cb2-301"></a><span class="st">  </span><span class="kw">cbind.data.frame</span>(dyads_cluster, dta[, <span class="kw">c</span>(<span class="st">&quot;p_cluster&quot;</span>, <span class="st">&quot;clust_new_order&quot;</span>)])</span>
<span id="cb2-302"><a href="data-processing-and-analysis.html#cb2-302"></a><span class="kw">saveRDS</span>(</span>
<span id="cb2-303"><a href="data-processing-and-analysis.html#cb2-303"></a>  dyads_cluster,</span>
<span id="cb2-304"><a href="data-processing-and-analysis.html#cb2-304"></a>  <span class="dt">file =</span> <span class="kw">paste0</span>(</span>
<span id="cb2-305"><a href="data-processing-and-analysis.html#cb2-305"></a>    dossier.data.outputs,</span>
<span id="cb2-306"><a href="data-processing-and-analysis.html#cb2-306"></a>    <span class="st">&#39;ClustPCAoutputs-PTM-&#39;</span>,</span>
<span id="cb2-307"><a href="data-processing-and-analysis.html#cb2-307"></a>    gear,</span>
<span id="cb2-308"><a href="data-processing-and-analysis.html#cb2-308"></a>    <span class="st">&#39;-&#39;</span>,</span>
<span id="cb2-309"><a href="data-processing-and-analysis.html#cb2-309"></a>    <span class="kw">paste0</span>(variables, <span class="dt">collapse =</span> <span class="st">&#39;-&#39;</span>),</span>
<span id="cb2-310"><a href="data-processing-and-analysis.html#cb2-310"></a>    <span class="st">&#39;_ordered.rds&#39;</span></span>
<span id="cb2-311"><a href="data-processing-and-analysis.html#cb2-311"></a>  )</span>
<span id="cb2-312"><a href="data-processing-and-analysis.html#cb2-312"></a>)</span>
<span id="cb2-313"><a href="data-processing-and-analysis.html#cb2-313"></a></span>
<span id="cb2-314"><a href="data-processing-and-analysis.html#cb2-314"></a><span class="co"># now we compute the stats and save them in .RData and a LaTeX table format</span></span>
<span id="cb2-315"><a href="data-processing-and-analysis.html#cb2-315"></a>stats.clusters &lt;-<span class="st"> </span><span class="kw">stats_clusters</span>(k, dyads_cluster)</span>
<span id="cb2-316"><a href="data-processing-and-analysis.html#cb2-316"></a></span>
<span id="cb2-317"><a href="data-processing-and-analysis.html#cb2-317"></a><span class="kw">save</span>(</span>
<span id="cb2-318"><a href="data-processing-and-analysis.html#cb2-318"></a>  stats.clusters,</span>
<span id="cb2-319"><a href="data-processing-and-analysis.html#cb2-319"></a>  <span class="dt">file =</span> <span class="kw">paste0</span>(</span>
<span id="cb2-320"><a href="data-processing-and-analysis.html#cb2-320"></a>    dossier.data.outputs,</span>
<span id="cb2-321"><a href="data-processing-and-analysis.html#cb2-321"></a>    <span class="st">&quot;ClusterTable-&quot;</span>,</span>
<span id="cb2-322"><a href="data-processing-and-analysis.html#cb2-322"></a>    k,</span>
<span id="cb2-323"><a href="data-processing-and-analysis.html#cb2-323"></a>    <span class="st">&#39;-PTM-&#39;</span>,</span>
<span id="cb2-324"><a href="data-processing-and-analysis.html#cb2-324"></a>    gear,</span>
<span id="cb2-325"><a href="data-processing-and-analysis.html#cb2-325"></a>    <span class="st">&#39;-&#39;</span>,</span>
<span id="cb2-326"><a href="data-processing-and-analysis.html#cb2-326"></a>    <span class="kw">paste</span>(variables, <span class="dt">collapse =</span> <span class="st">&#39;-&#39;</span>),</span>
<span id="cb2-327"><a href="data-processing-and-analysis.html#cb2-327"></a>    <span class="st">&#39;ordered.RData&#39;</span></span>
<span id="cb2-328"><a href="data-processing-and-analysis.html#cb2-328"></a>  )</span>
<span id="cb2-329"><a href="data-processing-and-analysis.html#cb2-329"></a>)</span>
<span id="cb2-330"><a href="data-processing-and-analysis.html#cb2-330"></a></span>
<span id="cb2-331"><a href="data-processing-and-analysis.html#cb2-331"></a><span class="kw">print</span>(</span>
<span id="cb2-332"><a href="data-processing-and-analysis.html#cb2-332"></a>  <span class="kw">xtable</span>(<span class="kw">t</span>(stats.clusters)),</span>
<span id="cb2-333"><a href="data-processing-and-analysis.html#cb2-333"></a>  <span class="dt">file =</span> <span class="kw">paste0</span>(</span>
<span id="cb2-334"><a href="data-processing-and-analysis.html#cb2-334"></a>    dossier.stats.outputs,</span>
<span id="cb2-335"><a href="data-processing-and-analysis.html#cb2-335"></a>    <span class="st">&quot;ClusterLatexTable-&quot;</span>,</span>
<span id="cb2-336"><a href="data-processing-and-analysis.html#cb2-336"></a>    k,</span>
<span id="cb2-337"><a href="data-processing-and-analysis.html#cb2-337"></a>    <span class="st">&#39;-PTM-&#39;</span>,</span>
<span id="cb2-338"><a href="data-processing-and-analysis.html#cb2-338"></a>    gear,</span>
<span id="cb2-339"><a href="data-processing-and-analysis.html#cb2-339"></a>    <span class="st">&#39;-&#39;</span>,</span>
<span id="cb2-340"><a href="data-processing-and-analysis.html#cb2-340"></a>    <span class="kw">paste</span>(variables, <span class="dt">collapse =</span> <span class="st">&#39;-&#39;</span>),</span>
<span id="cb2-341"><a href="data-processing-and-analysis.html#cb2-341"></a>    <span class="st">&#39;ordered.txt&#39;</span></span>
<span id="cb2-342"><a href="data-processing-and-analysis.html#cb2-342"></a>  )</span>
<span id="cb2-343"><a href="data-processing-and-analysis.html#cb2-343"></a>)</span></code></pre></div>
</div>
<div id="classifying-the-dyads-of-the-other-fleets" class="section level2">
<h2><span class="header-section-number">2.3</span> Classifying the dyads of the other fleets</h2>
<p>We use the Best GMM for pelagic pair trawlers to classify the other dyads into the 3 groups, by fleet. We also do the same graphs as for the pair trawlers (and some extras) and produce the statistics by cluster.
We use functions called above.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="data-processing-and-analysis.html#cb3-1"></a><span class="co"># Large bottom otter trawlers</span></span>
<span id="cb3-2"><a href="data-processing-and-analysis.html#cb3-2"></a><span class="kw">dyad_classif</span>(</span>
<span id="cb3-3"><a href="data-processing-and-analysis.html#cb3-3"></a><span class="dt">gear =</span> <span class="st">&quot;LOTB&quot;</span>,</span>
<span id="cb3-4"><a href="data-processing-and-analysis.html#cb3-4"></a>variables,</span>
<span id="cb3-5"><a href="data-processing-and-analysis.html#cb3-5"></a>dyads,</span>
<span id="cb3-6"><a href="data-processing-and-analysis.html#cb3-6"></a>BestModel,</span>
<span id="cb3-7"><a href="data-processing-and-analysis.html#cb3-7"></a>k,</span>
<span id="cb3-8"><a href="data-processing-and-analysis.html#cb3-8"></a>order_clust,</span>
<span id="cb3-9"><a href="data-processing-and-analysis.html#cb3-9"></a>cluster.file,</span>
<span id="cb3-10"><a href="data-processing-and-analysis.html#cb3-10"></a>dossier.stats.outputs,</span>
<span id="cb3-11"><a href="data-processing-and-analysis.html#cb3-11"></a>dossier.data.outputs,</span>
<span id="cb3-12"><a href="data-processing-and-analysis.html#cb3-12"></a>dta</span>
<span id="cb3-13"><a href="data-processing-and-analysis.html#cb3-13"></a>)</span>
<span id="cb3-14"><a href="data-processing-and-analysis.html#cb3-14"></a></span>
<span id="cb3-15"><a href="data-processing-and-analysis.html#cb3-15"></a><span class="co"># Small bottom otter trawlers</span></span>
<span id="cb3-16"><a href="data-processing-and-analysis.html#cb3-16"></a><span class="kw">dyad_classif</span>(</span>
<span id="cb3-17"><a href="data-processing-and-analysis.html#cb3-17"></a><span class="dt">gear =</span> <span class="st">&quot;SOTB&quot;</span>,</span>
<span id="cb3-18"><a href="data-processing-and-analysis.html#cb3-18"></a>variables,</span>
<span id="cb3-19"><a href="data-processing-and-analysis.html#cb3-19"></a>dyads,</span>
<span id="cb3-20"><a href="data-processing-and-analysis.html#cb3-20"></a>BestModel,</span>
<span id="cb3-21"><a href="data-processing-and-analysis.html#cb3-21"></a>k,</span>
<span id="cb3-22"><a href="data-processing-and-analysis.html#cb3-22"></a>order_clust,</span>
<span id="cb3-23"><a href="data-processing-and-analysis.html#cb3-23"></a>cluster.file,</span>
<span id="cb3-24"><a href="data-processing-and-analysis.html#cb3-24"></a>dossier.stats.outputs,</span>
<span id="cb3-25"><a href="data-processing-and-analysis.html#cb3-25"></a>dossier.data.outputs,</span>
<span id="cb3-26"><a href="data-processing-and-analysis.html#cb3-26"></a>dta</span>
<span id="cb3-27"><a href="data-processing-and-analysis.html#cb3-27"></a>)</span>
<span id="cb3-28"><a href="data-processing-and-analysis.html#cb3-28"></a></span>
<span id="cb3-29"><a href="data-processing-and-analysis.html#cb3-29"></a><span class="co"># Mid-water otter trawlers</span></span>
<span id="cb3-30"><a href="data-processing-and-analysis.html#cb3-30"></a><span class="kw">dyad_classif</span>(</span>
<span id="cb3-31"><a href="data-processing-and-analysis.html#cb3-31"></a><span class="dt">gear =</span> <span class="st">&quot;OTM&quot;</span>,</span>
<span id="cb3-32"><a href="data-processing-and-analysis.html#cb3-32"></a>variables,</span>
<span id="cb3-33"><a href="data-processing-and-analysis.html#cb3-33"></a>dyads,</span>
<span id="cb3-34"><a href="data-processing-and-analysis.html#cb3-34"></a>BestModel,</span>
<span id="cb3-35"><a href="data-processing-and-analysis.html#cb3-35"></a>k,</span>
<span id="cb3-36"><a href="data-processing-and-analysis.html#cb3-36"></a>order_clust,</span>
<span id="cb3-37"><a href="data-processing-and-analysis.html#cb3-37"></a>cluster.file,</span>
<span id="cb3-38"><a href="data-processing-and-analysis.html#cb3-38"></a>dossier.stats.outputs,</span>
<span id="cb3-39"><a href="data-processing-and-analysis.html#cb3-39"></a>dossier.data.outputs,</span>
<span id="cb3-40"><a href="data-processing-and-analysis.html#cb3-40"></a>dta</span>
<span id="cb3-41"><a href="data-processing-and-analysis.html#cb3-41"></a>)</span>
<span id="cb3-42"><a href="data-processing-and-analysis.html#cb3-42"></a></span>
<span id="cb3-43"><a href="data-processing-and-analysis.html#cb3-43"></a><span class="co"># Tuna purse-seiners</span></span>
<span id="cb3-44"><a href="data-processing-and-analysis.html#cb3-44"></a><span class="kw">dyad_classif</span>(</span>
<span id="cb3-45"><a href="data-processing-and-analysis.html#cb3-45"></a><span class="dt">gear =</span> <span class="st">&quot;thon&quot;</span>,</span>
<span id="cb3-46"><a href="data-processing-and-analysis.html#cb3-46"></a>variables,</span>
<span id="cb3-47"><a href="data-processing-and-analysis.html#cb3-47"></a>dyads,</span>
<span id="cb3-48"><a href="data-processing-and-analysis.html#cb3-48"></a>BestModel,</span>
<span id="cb3-49"><a href="data-processing-and-analysis.html#cb3-49"></a>k,</span>
<span id="cb3-50"><a href="data-processing-and-analysis.html#cb3-50"></a>order_clust,</span>
<span id="cb3-51"><a href="data-processing-and-analysis.html#cb3-51"></a>cluster.file,</span>
<span id="cb3-52"><a href="data-processing-and-analysis.html#cb3-52"></a>dossier.stats.outputs,</span>
<span id="cb3-53"><a href="data-processing-and-analysis.html#cb3-53"></a>dossier.data.outputs,</span>
<span id="cb3-54"><a href="data-processing-and-analysis.html#cb3-54"></a>dta</span>
<span id="cb3-55"><a href="data-processing-and-analysis.html#cb3-55"></a>)</span>
<span id="cb3-56"><a href="data-processing-and-analysis.html#cb3-56"></a></span>
<span id="cb3-57"><a href="data-processing-and-analysis.html#cb3-57"></a><span class="co"># Anchovy purse-seiners</span></span>
<span id="cb3-58"><a href="data-processing-and-analysis.html#cb3-58"></a><span class="kw">dyad_classif</span>(</span>
<span id="cb3-59"><a href="data-processing-and-analysis.html#cb3-59"></a><span class="dt">gear =</span> <span class="st">&quot;APS-10&quot;</span>,</span>
<span id="cb3-60"><a href="data-processing-and-analysis.html#cb3-60"></a>variables,</span>
<span id="cb3-61"><a href="data-processing-and-analysis.html#cb3-61"></a>dyads,</span>
<span id="cb3-62"><a href="data-processing-and-analysis.html#cb3-62"></a>BestModel,</span>
<span id="cb3-63"><a href="data-processing-and-analysis.html#cb3-63"></a>k,</span>
<span id="cb3-64"><a href="data-processing-and-analysis.html#cb3-64"></a>order_clust,</span>
<span id="cb3-65"><a href="data-processing-and-analysis.html#cb3-65"></a>cluster.file,</span>
<span id="cb3-66"><a href="data-processing-and-analysis.html#cb3-66"></a>dossier.stats.outputs,</span>
<span id="cb3-67"><a href="data-processing-and-analysis.html#cb3-67"></a>dossier.data.outputs,</span>
<span id="cb3-68"><a href="data-processing-and-analysis.html#cb3-68"></a>dta</span>
<span id="cb3-69"><a href="data-processing-and-analysis.html#cb3-69"></a>)</span></code></pre></div>
</div>
<div id="plots-and-animations-of-dyads-tracks-and-time-series-and-network-graphs" class="section level2">
<h2><span class="header-section-number">2.4</span> Plots and animations of dyad’s tracks and time series, and network graphs</h2>
<p>In order to reproduce this code, you would need the actual VMS data from the
fleets, which I cannot provide. Due to the same confidentiality issues, these
plots are anonymous, without coastlines and the longitude and latitude
coordinates are transformed.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="data-processing-and-analysis.html#cb4-1"></a><span class="co"># We first set some values for parameters</span></span>
<span id="cb4-2"><a href="data-processing-and-analysis.html#cb4-2"></a>video.par &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb4-3"><a href="data-processing-and-analysis.html#cb4-3"></a>video.par<span class="op">$</span>type &lt;-</span>
<span id="cb4-4"><a href="data-processing-and-analysis.html#cb4-4"></a><span class="st">&#39;plot&#39;</span> <span class="co"># choose between video, plot, series and all</span></span>
<span id="cb4-5"><a href="data-processing-and-analysis.html#cb4-5"></a>video.par<span class="op">$</span>mp4 &lt;-</span>
<span id="cb4-6"><a href="data-processing-and-analysis.html#cb4-6"></a><span class="ot">FALSE</span> <span class="co"># IF SO, ffmpeg function must be able to run in the konsole</span></span>
<span id="cb4-7"><a href="data-processing-and-analysis.html#cb4-7"></a>video.par<span class="op">$</span>gif &lt;-<span class="st"> </span><span class="ot">FALSE</span> <span class="co"># Or TRUE</span></span>
<span id="cb4-8"><a href="data-processing-and-analysis.html#cb4-8"></a>video.par<span class="op">$</span>html &lt;-</span>
<span id="cb4-9"><a href="data-processing-and-analysis.html#cb4-9"></a><span class="ot">FALSE</span> <span class="co"># we need this to be TRUE to create mp4 anyway</span></span>
<span id="cb4-10"><a href="data-processing-and-analysis.html#cb4-10"></a>video.par<span class="op">$</span>series_gif &lt;-</span>
<span id="cb4-11"><a href="data-processing-and-analysis.html#cb4-11"></a><span class="ot">FALSE</span> <span class="co"># Or TRUE. To produce gifs of time series of the metrics</span></span>
<span id="cb4-12"><a href="data-processing-and-analysis.html#cb4-12"></a>video.par<span class="op">$</span>series_pdf &lt;-</span>
<span id="cb4-13"><a href="data-processing-and-analysis.html#cb4-13"></a><span class="ot">FALSE</span> <span class="co"># Or TRUE. To produce pdf graphs of time series of the metrics</span></span>
<span id="cb4-14"><a href="data-processing-and-analysis.html#cb4-14"></a>video.par<span class="op">$</span>traza =<span class="st"> </span><span class="dv">10</span> <span class="co"># number of hours for leaving a trace at each frame in the video</span></span>
<span id="cb4-15"><a href="data-processing-and-analysis.html#cb4-15"></a>video.par<span class="op">$</span>epais =<span class="st"> </span><span class="dv">4</span> <span class="co"># width of trajectories</span></span>
<span id="cb4-16"><a href="data-processing-and-analysis.html#cb4-16"></a>video.par<span class="op">$</span>sleep =<span class="st"> </span><span class="fl">0.25</span> <span class="co"># time between frames (quarter of a second)</span></span>
<span id="cb4-17"><a href="data-processing-and-analysis.html#cb4-17"></a>video.par<span class="op">$</span>point.size =<span class="st"> </span><span class="fl">1.2</span> <span class="co"># size of points in the plots and animations</span></span>
<span id="cb4-18"><a href="data-processing-and-analysis.html#cb4-18"></a></span>
<span id="cb4-19"><a href="data-processing-and-analysis.html#cb4-19"></a><span class="co"># VMS data</span></span>
<span id="cb4-20"><a href="data-processing-and-analysis.html#cb4-20"></a><span class="kw">load</span>(<span class="kw">paste0</span>(dossier.data.outputs,<span class="st">&#39;DATA_TRAJECTORIES_YEAR_2012_GAP_3H.rdata&#39;</span>))</span>
<span id="cb4-21"><a href="data-processing-and-analysis.html#cb4-21"></a>vms_data_<span class="dv">2012</span> &lt;-<span class="st"> </span>data.trajectories<span class="op">$</span>DATA.TRAJECTORIES</span>
<span id="cb4-22"><a href="data-processing-and-analysis.html#cb4-22"></a><span class="kw">load</span>(<span class="kw">paste0</span>(dossier.data.outputs,<span class="st">&#39;DATA_TRAJECTORIES_YEAR_2013_GAP_3H.rdata&#39;</span>))</span>
<span id="cb4-23"><a href="data-processing-and-analysis.html#cb4-23"></a>vms_data_<span class="dv">2013</span> &lt;-<span class="st"> </span>data.trajectories<span class="op">$</span>DATA.TRAJECTORIES</span>
<span id="cb4-24"><a href="data-processing-and-analysis.html#cb4-24"></a>vms_trawlers &lt;-<span class="st"> </span><span class="kw">rbind.data.frame</span>(vms_data_<span class="dv">2012</span>, vms_data_<span class="dv">2013</span>)</span>
<span id="cb4-25"><a href="data-processing-and-analysis.html#cb4-25"></a>old_names &lt;-<span class="st"> </span><span class="kw">colnames</span>(vms_trawlers)</span>
<span id="cb4-26"><a href="data-processing-and-analysis.html#cb4-26"></a><span class="kw">colnames</span>(vms_trawlers) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>, <span class="st">&quot;date&quot;</span>, old_names[<span class="dv">4</span><span class="op">:</span><span class="dv">8</span>],</span>
<span id="cb4-27"><a href="data-processing-and-analysis.html#cb4-27"></a>                             <span class="st">&quot;abs.angle&quot;</span>, old_names[<span class="dv">10</span>], <span class="st">&quot;id&quot;</span>, <span class="st">&quot;burst&quot;</span>,</span>
<span id="cb4-28"><a href="data-processing-and-analysis.html#cb4-28"></a>                             old_names[<span class="dv">13</span><span class="op">:</span><span class="dv">30</span>], <span class="st">&quot;gear.maree&quot;</span>, old_names[<span class="dv">32</span>],</span>
<span id="cb4-29"><a href="data-processing-and-analysis.html#cb4-29"></a>                             <span class="st">&quot;LONGITUDE&quot;</span>, <span class="st">&quot;LATITUDE&quot;</span>, <span class="st">&#39;line&#39;</span>, old_names[<span class="dv">36</span><span class="op">:</span><span class="dv">38</span>])</span>
<span id="cb4-30"><a href="data-processing-and-analysis.html#cb4-30"></a><span class="kw">rm</span>(vms_data_<span class="dv">2012</span>, vms_data_<span class="dv">2013</span>, data.trajectories)</span>
<span id="cb4-31"><a href="data-processing-and-analysis.html#cb4-31"></a></span>
<span id="cb4-32"><a href="data-processing-and-analysis.html#cb4-32"></a><span class="kw">load</span>(<span class="kw">paste0</span>(dossier.data.outputs, <span class="st">&#39;vms_thon_2011-2013.RData&#39;</span>))</span>
<span id="cb4-33"><a href="data-processing-and-analysis.html#cb4-33"></a>vms_thon &lt;-<span class="st"> </span>vms.data.years</span>
<span id="cb4-34"><a href="data-processing-and-analysis.html#cb4-34"></a><span class="kw">load</span>(<span class="kw">paste0</span>(dossier.data.outputs, <span class="st">&quot;vms_data_10.RData&quot;</span>))</span>
<span id="cb4-35"><a href="data-processing-and-analysis.html#cb4-35"></a>vms_aps &lt;-<span class="st"> </span>vms.data</span>
<span id="cb4-36"><a href="data-processing-and-analysis.html#cb4-36"></a></span>
<span id="cb4-37"><a href="data-processing-and-analysis.html#cb4-37"></a><span class="co"># For pelagic pair trawlers</span></span>
<span id="cb4-38"><a href="data-processing-and-analysis.html#cb4-38"></a></span>
<span id="cb4-39"><a href="data-processing-and-analysis.html#cb4-39"></a>vms_ptm &lt;-</span>
<span id="cb4-40"><a href="data-processing-and-analysis.html#cb4-40"></a>vms_trawlers[<span class="kw">which</span>(<span class="kw">as.character</span>(vms_trawlers<span class="op">$</span>gear.maree) <span class="op">==</span><span class="st"> &quot;PTM&quot;</span>), ]</span>
<span id="cb4-41"><a href="data-processing-and-analysis.html#cb4-41"></a>dyads_ptm &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="dt">file =</span> <span class="kw">paste0</span>(</span>
<span id="cb4-42"><a href="data-processing-and-analysis.html#cb4-42"></a>dossier.data.outputs,</span>
<span id="cb4-43"><a href="data-processing-and-analysis.html#cb4-43"></a><span class="st">&#39;ClustPCAoutputs-PTM-all-&#39;</span>,</span>
<span id="cb4-44"><a href="data-processing-and-analysis.html#cb4-44"></a><span class="kw">paste0</span>(variables, <span class="dt">collapse =</span> <span class="st">&#39;-&#39;</span>),</span>
<span id="cb4-45"><a href="data-processing-and-analysis.html#cb4-45"></a><span class="st">&#39;_ordered.rds&#39;</span></span>
<span id="cb4-46"><a href="data-processing-and-analysis.html#cb4-46"></a>))</span>
<span id="cb4-47"><a href="data-processing-and-analysis.html#cb4-47"></a></span>
<span id="cb4-48"><a href="data-processing-and-analysis.html#cb4-48"></a>columns &lt;-</span>
<span id="cb4-49"><a href="data-processing-and-analysis.html#cb4-49"></a><span class="kw">c</span>(<span class="st">&quot;x&quot;</span>,</span>
<span id="cb4-50"><a href="data-processing-and-analysis.html#cb4-50"></a><span class="st">&quot;y&quot;</span>,</span>
<span id="cb4-51"><a href="data-processing-and-analysis.html#cb4-51"></a><span class="st">&quot;date&quot;</span>,</span>
<span id="cb4-52"><a href="data-processing-and-analysis.html#cb4-52"></a><span class="st">&quot;id&quot;</span>,</span>
<span id="cb4-53"><a href="data-processing-and-analysis.html#cb4-53"></a><span class="st">&quot;burst&quot;</span>,</span>
<span id="cb4-54"><a href="data-processing-and-analysis.html#cb4-54"></a><span class="st">&quot;abs.angle&quot;</span>,</span>
<span id="cb4-55"><a href="data-processing-and-analysis.html#cb4-55"></a><span class="st">&quot;LONGITUDE&quot;</span>,</span>
<span id="cb4-56"><a href="data-processing-and-analysis.html#cb4-56"></a><span class="st">&quot;LATITUDE&quot;</span>,</span>
<span id="cb4-57"><a href="data-processing-and-analysis.html#cb4-57"></a><span class="st">&quot;line&quot;</span>)</span>
<span id="cb4-58"><a href="data-processing-and-analysis.html#cb4-58"></a>vms.data &lt;-<span class="st"> </span>vms_ptm[, columns]</span>
<span id="cb4-59"><a href="data-processing-and-analysis.html#cb4-59"></a></span>
<span id="cb4-60"><a href="data-processing-and-analysis.html#cb4-60"></a>Prox_delta &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>)</span>
<span id="cb4-61"><a href="data-processing-and-analysis.html#cb4-61"></a>DI_beta &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb4-62"><a href="data-processing-and-analysis.html#cb4-62"></a></span>
<span id="cb4-63"><a href="data-processing-and-analysis.html#cb4-63"></a><span class="kw">plots.video.dyads.allgears</span>(</span>
<span id="cb4-64"><a href="data-processing-and-analysis.html#cb4-64"></a>vms.data,</span>
<span id="cb4-65"><a href="data-processing-and-analysis.html#cb4-65"></a><span class="dt">dyads =</span> dyads_ptm,</span>
<span id="cb4-66"><a href="data-processing-and-analysis.html#cb4-66"></a><span class="dt">n =</span> <span class="dv">1</span>,</span>
<span id="cb4-67"><a href="data-processing-and-analysis.html#cb4-67"></a><span class="dt">gear =</span> <span class="st">&quot;PTM&quot;</span>,</span>
<span id="cb4-68"><a href="data-processing-and-analysis.html#cb4-68"></a><span class="dt">new.variables =</span> variables,</span>
<span id="cb4-69"><a href="data-processing-and-analysis.html#cb4-69"></a>dossier.data.outputs,</span>
<span id="cb4-70"><a href="data-processing-and-analysis.html#cb4-70"></a>dossier.stats.outputs,</span>
<span id="cb4-71"><a href="data-processing-and-analysis.html#cb4-71"></a><span class="dt">text.dyads =</span> <span class="ot">TRUE</span>,</span>
<span id="cb4-72"><a href="data-processing-and-analysis.html#cb4-72"></a>video.par,</span>
<span id="cb4-73"><a href="data-processing-and-analysis.html#cb4-73"></a><span class="dt">colores =</span> <span class="kw">c</span>(<span class="st">&quot;#66c2a5&quot;</span>, <span class="st">&quot;#fc8d62&quot;</span>, <span class="st">&quot;#8da0cb&quot;</span>)</span>
<span id="cb4-74"><a href="data-processing-and-analysis.html#cb4-74"></a>)</span>
<span id="cb4-75"><a href="data-processing-and-analysis.html#cb4-75"></a></span>
<span id="cb4-76"><a href="data-processing-and-analysis.html#cb4-76"></a><span class="kw">Fleet.Analysis</span>(</span>
<span id="cb4-77"><a href="data-processing-and-analysis.html#cb4-77"></a>vms.data,</span>
<span id="cb4-78"><a href="data-processing-and-analysis.html#cb4-78"></a><span class="dt">dyads =</span> dyads_ptm,</span>
<span id="cb4-79"><a href="data-processing-and-analysis.html#cb4-79"></a>dossier.data.outputs,</span>
<span id="cb4-80"><a href="data-processing-and-analysis.html#cb4-80"></a>dossier.stats.outputs,</span>
<span id="cb4-81"><a href="data-processing-and-analysis.html#cb4-81"></a><span class="dt">gear =</span> <span class="st">&quot;PTM&quot;</span></span>
<span id="cb4-82"><a href="data-processing-and-analysis.html#cb4-82"></a>)</span>
<span id="cb4-83"><a href="data-processing-and-analysis.html#cb4-83"></a></span>
<span id="cb4-84"><a href="data-processing-and-analysis.html#cb4-84"></a><span class="co"># For larger bottom otter trawlers</span></span>
<span id="cb4-85"><a href="data-processing-and-analysis.html#cb4-85"></a></span>
<span id="cb4-86"><a href="data-processing-and-analysis.html#cb4-86"></a>vms_lotb &lt;-</span>
<span id="cb4-87"><a href="data-processing-and-analysis.html#cb4-87"></a>vms_trawlers[<span class="kw">which</span>(<span class="kw">as.character</span>(vms_trawlers<span class="op">$</span>gear.maree) <span class="op">==</span><span class="st"> &quot;OTB&quot;</span>), ]</span>
<span id="cb4-88"><a href="data-processing-and-analysis.html#cb4-88"></a>dyads_lotb &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="dt">file =</span> <span class="kw">paste0</span>(</span>
<span id="cb4-89"><a href="data-processing-and-analysis.html#cb4-89"></a>dossier.data.outputs,</span>
<span id="cb4-90"><a href="data-processing-and-analysis.html#cb4-90"></a><span class="st">&#39;ClustPCAoutputs-PTM-LOTB-&#39;</span>,</span>
<span id="cb4-91"><a href="data-processing-and-analysis.html#cb4-91"></a><span class="kw">paste0</span>(variables, <span class="dt">collapse =</span> <span class="st">&#39;-&#39;</span>),</span>
<span id="cb4-92"><a href="data-processing-and-analysis.html#cb4-92"></a><span class="st">&#39;_ordered.rds&#39;</span></span>
<span id="cb4-93"><a href="data-processing-and-analysis.html#cb4-93"></a>))</span>
<span id="cb4-94"><a href="data-processing-and-analysis.html#cb4-94"></a></span>
<span id="cb4-95"><a href="data-processing-and-analysis.html#cb4-95"></a>columns &lt;-</span>
<span id="cb4-96"><a href="data-processing-and-analysis.html#cb4-96"></a><span class="kw">c</span>(<span class="st">&quot;x&quot;</span>,</span>
<span id="cb4-97"><a href="data-processing-and-analysis.html#cb4-97"></a><span class="st">&quot;y&quot;</span>,</span>
<span id="cb4-98"><a href="data-processing-and-analysis.html#cb4-98"></a><span class="st">&quot;date&quot;</span>,</span>
<span id="cb4-99"><a href="data-processing-and-analysis.html#cb4-99"></a><span class="st">&quot;id&quot;</span>,</span>
<span id="cb4-100"><a href="data-processing-and-analysis.html#cb4-100"></a><span class="st">&quot;burst&quot;</span>,</span>
<span id="cb4-101"><a href="data-processing-and-analysis.html#cb4-101"></a><span class="st">&quot;abs.angle&quot;</span>,</span>
<span id="cb4-102"><a href="data-processing-and-analysis.html#cb4-102"></a><span class="st">&quot;LONGITUDE&quot;</span>,</span>
<span id="cb4-103"><a href="data-processing-and-analysis.html#cb4-103"></a><span class="st">&quot;LATITUDE&quot;</span>,</span>
<span id="cb4-104"><a href="data-processing-and-analysis.html#cb4-104"></a><span class="st">&quot;line&quot;</span>)</span>
<span id="cb4-105"><a href="data-processing-and-analysis.html#cb4-105"></a>vms.data &lt;-<span class="st"> </span>vms_lotb[, columns]</span>
<span id="cb4-106"><a href="data-processing-and-analysis.html#cb4-106"></a></span>
<span id="cb4-107"><a href="data-processing-and-analysis.html#cb4-107"></a>Prox_delta &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>)</span>
<span id="cb4-108"><a href="data-processing-and-analysis.html#cb4-108"></a>DI_beta &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb4-109"><a href="data-processing-and-analysis.html#cb4-109"></a></span>
<span id="cb4-110"><a href="data-processing-and-analysis.html#cb4-110"></a><span class="kw">plots.video.dyads.allgears</span>(</span>
<span id="cb4-111"><a href="data-processing-and-analysis.html#cb4-111"></a>vms.data,</span>
<span id="cb4-112"><a href="data-processing-and-analysis.html#cb4-112"></a><span class="dt">dyads =</span> dyads_lotb,</span>
<span id="cb4-113"><a href="data-processing-and-analysis.html#cb4-113"></a><span class="dt">n =</span> <span class="dv">1</span>,</span>
<span id="cb4-114"><a href="data-processing-and-analysis.html#cb4-114"></a><span class="dt">gear =</span> <span class="st">&quot;LOTB&quot;</span>,</span>
<span id="cb4-115"><a href="data-processing-and-analysis.html#cb4-115"></a><span class="dt">new.variables =</span> variables,</span>
<span id="cb4-116"><a href="data-processing-and-analysis.html#cb4-116"></a>dossier.data.outputs,</span>
<span id="cb4-117"><a href="data-processing-and-analysis.html#cb4-117"></a>dossier.stats.outputs,</span>
<span id="cb4-118"><a href="data-processing-and-analysis.html#cb4-118"></a><span class="dt">text.dyads =</span> <span class="ot">TRUE</span>,</span>
<span id="cb4-119"><a href="data-processing-and-analysis.html#cb4-119"></a>video.par,</span>
<span id="cb4-120"><a href="data-processing-and-analysis.html#cb4-120"></a><span class="dt">colores =</span> <span class="kw">c</span>(<span class="st">&quot;#66c2a5&quot;</span>, <span class="st">&quot;#fc8d62&quot;</span>, <span class="st">&quot;#8da0cb&quot;</span>)</span>
<span id="cb4-121"><a href="data-processing-and-analysis.html#cb4-121"></a>)</span>
<span id="cb4-122"><a href="data-processing-and-analysis.html#cb4-122"></a></span>
<span id="cb4-123"><a href="data-processing-and-analysis.html#cb4-123"></a><span class="kw">Fleet.Analysis</span>(</span>
<span id="cb4-124"><a href="data-processing-and-analysis.html#cb4-124"></a>vms.data,</span>
<span id="cb4-125"><a href="data-processing-and-analysis.html#cb4-125"></a><span class="dt">dyads =</span> dyads_lotb,</span>
<span id="cb4-126"><a href="data-processing-and-analysis.html#cb4-126"></a>dossier.data.outputs,</span>
<span id="cb4-127"><a href="data-processing-and-analysis.html#cb4-127"></a>dossier.stats.outputs,</span>
<span id="cb4-128"><a href="data-processing-and-analysis.html#cb4-128"></a><span class="dt">gear =</span> <span class="st">&quot;LOTB&quot;</span></span>
<span id="cb4-129"><a href="data-processing-and-analysis.html#cb4-129"></a>)</span>
<span id="cb4-130"><a href="data-processing-and-analysis.html#cb4-130"></a></span>
<span id="cb4-131"><a href="data-processing-and-analysis.html#cb4-131"></a><span class="co"># For small bottom otter trawlers</span></span>
<span id="cb4-132"><a href="data-processing-and-analysis.html#cb4-132"></a></span>
<span id="cb4-133"><a href="data-processing-and-analysis.html#cb4-133"></a>vms_sotb &lt;-</span>
<span id="cb4-134"><a href="data-processing-and-analysis.html#cb4-134"></a>vms_trawlers[<span class="kw">which</span>(<span class="kw">as.character</span>(vms_trawlers<span class="op">$</span>gear.maree) <span class="op">==</span><span class="st"> &quot;OTB_SMALL&quot;</span>), ]</span>
<span id="cb4-135"><a href="data-processing-and-analysis.html#cb4-135"></a>dyads_sotb &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="dt">file =</span> <span class="kw">paste0</span>(</span>
<span id="cb4-136"><a href="data-processing-and-analysis.html#cb4-136"></a>dossier.data.outputs,</span>
<span id="cb4-137"><a href="data-processing-and-analysis.html#cb4-137"></a><span class="st">&#39;ClustPCAoutputs-PTM-SOTB-&#39;</span>,</span>
<span id="cb4-138"><a href="data-processing-and-analysis.html#cb4-138"></a><span class="kw">paste0</span>(variables, <span class="dt">collapse =</span> <span class="st">&#39;-&#39;</span>),</span>
<span id="cb4-139"><a href="data-processing-and-analysis.html#cb4-139"></a><span class="st">&#39;_ordered.rds&#39;</span></span>
<span id="cb4-140"><a href="data-processing-and-analysis.html#cb4-140"></a>))</span>
<span id="cb4-141"><a href="data-processing-and-analysis.html#cb4-141"></a></span>
<span id="cb4-142"><a href="data-processing-and-analysis.html#cb4-142"></a>columns &lt;-</span>
<span id="cb4-143"><a href="data-processing-and-analysis.html#cb4-143"></a><span class="kw">c</span>(<span class="st">&quot;x&quot;</span>,</span>
<span id="cb4-144"><a href="data-processing-and-analysis.html#cb4-144"></a><span class="st">&quot;y&quot;</span>,</span>
<span id="cb4-145"><a href="data-processing-and-analysis.html#cb4-145"></a><span class="st">&quot;date&quot;</span>,</span>
<span id="cb4-146"><a href="data-processing-and-analysis.html#cb4-146"></a><span class="st">&quot;id&quot;</span>,</span>
<span id="cb4-147"><a href="data-processing-and-analysis.html#cb4-147"></a><span class="st">&quot;burst&quot;</span>,</span>
<span id="cb4-148"><a href="data-processing-and-analysis.html#cb4-148"></a><span class="st">&quot;abs.angle&quot;</span>,</span>
<span id="cb4-149"><a href="data-processing-and-analysis.html#cb4-149"></a><span class="st">&quot;LONGITUDE&quot;</span>,</span>
<span id="cb4-150"><a href="data-processing-and-analysis.html#cb4-150"></a><span class="st">&quot;LATITUDE&quot;</span>,</span>
<span id="cb4-151"><a href="data-processing-and-analysis.html#cb4-151"></a><span class="st">&quot;line&quot;</span>)</span>
<span id="cb4-152"><a href="data-processing-and-analysis.html#cb4-152"></a>vms.data &lt;-<span class="st"> </span>vms_sotb[, columns]</span>
<span id="cb4-153"><a href="data-processing-and-analysis.html#cb4-153"></a></span>
<span id="cb4-154"><a href="data-processing-and-analysis.html#cb4-154"></a>Prox_delta &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>)</span>
<span id="cb4-155"><a href="data-processing-and-analysis.html#cb4-155"></a>DI_beta &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb4-156"><a href="data-processing-and-analysis.html#cb4-156"></a></span>
<span id="cb4-157"><a href="data-processing-and-analysis.html#cb4-157"></a><span class="kw">plots.video.dyads.allgears</span>(</span>
<span id="cb4-158"><a href="data-processing-and-analysis.html#cb4-158"></a>vms.data,</span>
<span id="cb4-159"><a href="data-processing-and-analysis.html#cb4-159"></a><span class="dt">dyads =</span> dyads_sotb,</span>
<span id="cb4-160"><a href="data-processing-and-analysis.html#cb4-160"></a><span class="dt">n =</span> <span class="dv">1</span>,</span>
<span id="cb4-161"><a href="data-processing-and-analysis.html#cb4-161"></a><span class="dt">gear =</span> <span class="st">&quot;SOTB&quot;</span>,</span>
<span id="cb4-162"><a href="data-processing-and-analysis.html#cb4-162"></a><span class="dt">new.variables =</span> variables,</span>
<span id="cb4-163"><a href="data-processing-and-analysis.html#cb4-163"></a>dossier.data.outputs,</span>
<span id="cb4-164"><a href="data-processing-and-analysis.html#cb4-164"></a>dossier.stats.outputs,</span>
<span id="cb4-165"><a href="data-processing-and-analysis.html#cb4-165"></a><span class="dt">text.dyads =</span> <span class="ot">TRUE</span>,</span>
<span id="cb4-166"><a href="data-processing-and-analysis.html#cb4-166"></a>video.par,</span>
<span id="cb4-167"><a href="data-processing-and-analysis.html#cb4-167"></a><span class="dt">colores =</span> <span class="kw">c</span>(<span class="st">&quot;#66c2a5&quot;</span>, <span class="st">&quot;#fc8d62&quot;</span>, <span class="st">&quot;#8da0cb&quot;</span>)</span>
<span id="cb4-168"><a href="data-processing-and-analysis.html#cb4-168"></a>)</span>
<span id="cb4-169"><a href="data-processing-and-analysis.html#cb4-169"></a></span>
<span id="cb4-170"><a href="data-processing-and-analysis.html#cb4-170"></a><span class="kw">Fleet.Analysis</span>(</span>
<span id="cb4-171"><a href="data-processing-and-analysis.html#cb4-171"></a>vms.data,</span>
<span id="cb4-172"><a href="data-processing-and-analysis.html#cb4-172"></a><span class="dt">dyads =</span> dyads_sotb,</span>
<span id="cb4-173"><a href="data-processing-and-analysis.html#cb4-173"></a>dossier.data.outputs,</span>
<span id="cb4-174"><a href="data-processing-and-analysis.html#cb4-174"></a>dossier.stats.outputs,</span>
<span id="cb4-175"><a href="data-processing-and-analysis.html#cb4-175"></a><span class="dt">gear =</span> <span class="st">&quot;SOTB&quot;</span></span>
<span id="cb4-176"><a href="data-processing-and-analysis.html#cb4-176"></a>)</span>
<span id="cb4-177"><a href="data-processing-and-analysis.html#cb4-177"></a></span>
<span id="cb4-178"><a href="data-processing-and-analysis.html#cb4-178"></a><span class="co"># For mid-water otter trawlers</span></span>
<span id="cb4-179"><a href="data-processing-and-analysis.html#cb4-179"></a></span>
<span id="cb4-180"><a href="data-processing-and-analysis.html#cb4-180"></a>vms_otm &lt;-</span>
<span id="cb4-181"><a href="data-processing-and-analysis.html#cb4-181"></a>vms_trawlers[<span class="kw">which</span>(<span class="kw">as.character</span>(vms_trawlers<span class="op">$</span>gear.maree) <span class="op">==</span><span class="st"> &quot;OTM&quot;</span>), ]</span>
<span id="cb4-182"><a href="data-processing-and-analysis.html#cb4-182"></a>dyads_otm &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="dt">file =</span> <span class="kw">paste0</span>(</span>
<span id="cb4-183"><a href="data-processing-and-analysis.html#cb4-183"></a>dossier.data.outputs,</span>
<span id="cb4-184"><a href="data-processing-and-analysis.html#cb4-184"></a><span class="st">&#39;ClustPCAoutputs-PTM-OTM-&#39;</span>,</span>
<span id="cb4-185"><a href="data-processing-and-analysis.html#cb4-185"></a><span class="kw">paste0</span>(variables, <span class="dt">collapse =</span> <span class="st">&#39;-&#39;</span>),</span>
<span id="cb4-186"><a href="data-processing-and-analysis.html#cb4-186"></a><span class="st">&#39;_ordered.rds&#39;</span></span>
<span id="cb4-187"><a href="data-processing-and-analysis.html#cb4-187"></a>))</span>
<span id="cb4-188"><a href="data-processing-and-analysis.html#cb4-188"></a></span>
<span id="cb4-189"><a href="data-processing-and-analysis.html#cb4-189"></a>columns &lt;-</span>
<span id="cb4-190"><a href="data-processing-and-analysis.html#cb4-190"></a><span class="kw">c</span>(<span class="st">&quot;x&quot;</span>,</span>
<span id="cb4-191"><a href="data-processing-and-analysis.html#cb4-191"></a><span class="st">&quot;y&quot;</span>,</span>
<span id="cb4-192"><a href="data-processing-and-analysis.html#cb4-192"></a><span class="st">&quot;date&quot;</span>,</span>
<span id="cb4-193"><a href="data-processing-and-analysis.html#cb4-193"></a><span class="st">&quot;id&quot;</span>,</span>
<span id="cb4-194"><a href="data-processing-and-analysis.html#cb4-194"></a><span class="st">&quot;burst&quot;</span>,</span>
<span id="cb4-195"><a href="data-processing-and-analysis.html#cb4-195"></a><span class="st">&quot;abs.angle&quot;</span>,</span>
<span id="cb4-196"><a href="data-processing-and-analysis.html#cb4-196"></a><span class="st">&quot;LONGITUDE&quot;</span>,</span>
<span id="cb4-197"><a href="data-processing-and-analysis.html#cb4-197"></a><span class="st">&quot;LATITUDE&quot;</span>,</span>
<span id="cb4-198"><a href="data-processing-and-analysis.html#cb4-198"></a><span class="st">&quot;line&quot;</span>)</span>
<span id="cb4-199"><a href="data-processing-and-analysis.html#cb4-199"></a>vms.data &lt;-<span class="st"> </span>vms_otm[, columns]</span>
<span id="cb4-200"><a href="data-processing-and-analysis.html#cb4-200"></a></span>
<span id="cb4-201"><a href="data-processing-and-analysis.html#cb4-201"></a>Prox_delta &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>)</span>
<span id="cb4-202"><a href="data-processing-and-analysis.html#cb4-202"></a>DI_beta &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb4-203"><a href="data-processing-and-analysis.html#cb4-203"></a></span>
<span id="cb4-204"><a href="data-processing-and-analysis.html#cb4-204"></a><span class="kw">plots.video.dyads.allgears</span>(</span>
<span id="cb4-205"><a href="data-processing-and-analysis.html#cb4-205"></a>vms.data,</span>
<span id="cb4-206"><a href="data-processing-and-analysis.html#cb4-206"></a><span class="dt">dyads =</span> dyads_otm,</span>
<span id="cb4-207"><a href="data-processing-and-analysis.html#cb4-207"></a><span class="dt">n =</span> <span class="dv">1</span>,</span>
<span id="cb4-208"><a href="data-processing-and-analysis.html#cb4-208"></a><span class="dt">gear =</span> <span class="st">&quot;OTM&quot;</span>,</span>
<span id="cb4-209"><a href="data-processing-and-analysis.html#cb4-209"></a><span class="dt">new.variables =</span> variables,</span>
<span id="cb4-210"><a href="data-processing-and-analysis.html#cb4-210"></a>dossier.data.outputs,</span>
<span id="cb4-211"><a href="data-processing-and-analysis.html#cb4-211"></a>dossier.stats.outputs,</span>
<span id="cb4-212"><a href="data-processing-and-analysis.html#cb4-212"></a><span class="dt">text.dyads =</span> <span class="ot">TRUE</span>,</span>
<span id="cb4-213"><a href="data-processing-and-analysis.html#cb4-213"></a>video.par,</span>
<span id="cb4-214"><a href="data-processing-and-analysis.html#cb4-214"></a><span class="dt">colores =</span> <span class="kw">c</span>(<span class="st">&quot;#66c2a5&quot;</span>, <span class="st">&quot;#fc8d62&quot;</span>, <span class="st">&quot;#8da0cb&quot;</span>)</span>
<span id="cb4-215"><a href="data-processing-and-analysis.html#cb4-215"></a>)</span>
<span id="cb4-216"><a href="data-processing-and-analysis.html#cb4-216"></a></span>
<span id="cb4-217"><a href="data-processing-and-analysis.html#cb4-217"></a><span class="kw">Fleet.Analysis</span>(</span>
<span id="cb4-218"><a href="data-processing-and-analysis.html#cb4-218"></a>vms.data,</span>
<span id="cb4-219"><a href="data-processing-and-analysis.html#cb4-219"></a><span class="dt">dyads =</span> dyads_otm,</span>
<span id="cb4-220"><a href="data-processing-and-analysis.html#cb4-220"></a>dossier.data.outputs,</span>
<span id="cb4-221"><a href="data-processing-and-analysis.html#cb4-221"></a>dossier.stats.outputs,</span>
<span id="cb4-222"><a href="data-processing-and-analysis.html#cb4-222"></a><span class="dt">gear =</span> <span class="st">&quot;OTM&quot;</span></span>
<span id="cb4-223"><a href="data-processing-and-analysis.html#cb4-223"></a>)</span>
<span id="cb4-224"><a href="data-processing-and-analysis.html#cb4-224"></a></span>
<span id="cb4-225"><a href="data-processing-and-analysis.html#cb4-225"></a><span class="co"># For tuna purse-seiners</span></span>
<span id="cb4-226"><a href="data-processing-and-analysis.html#cb4-226"></a></span>
<span id="cb4-227"><a href="data-processing-and-analysis.html#cb4-227"></a>dyads_tps &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="dt">file =</span> <span class="kw">paste0</span>(</span>
<span id="cb4-228"><a href="data-processing-and-analysis.html#cb4-228"></a>dossier.data.outputs,</span>
<span id="cb4-229"><a href="data-processing-and-analysis.html#cb4-229"></a><span class="st">&#39;ClustPCAoutputs-PTM-thon-&#39;</span>,</span>
<span id="cb4-230"><a href="data-processing-and-analysis.html#cb4-230"></a><span class="kw">paste0</span>(variables, <span class="dt">collapse =</span> <span class="st">&#39;-&#39;</span>),</span>
<span id="cb4-231"><a href="data-processing-and-analysis.html#cb4-231"></a><span class="st">&#39;_ordered.rds&#39;</span></span>
<span id="cb4-232"><a href="data-processing-and-analysis.html#cb4-232"></a>))</span>
<span id="cb4-233"><a href="data-processing-and-analysis.html#cb4-233"></a></span>
<span id="cb4-234"><a href="data-processing-and-analysis.html#cb4-234"></a>columns &lt;-</span>
<span id="cb4-235"><a href="data-processing-and-analysis.html#cb4-235"></a><span class="kw">c</span>(<span class="st">&quot;x&quot;</span>,</span>
<span id="cb4-236"><a href="data-processing-and-analysis.html#cb4-236"></a><span class="st">&quot;y&quot;</span>,</span>
<span id="cb4-237"><a href="data-processing-and-analysis.html#cb4-237"></a><span class="st">&quot;date&quot;</span>,</span>
<span id="cb4-238"><a href="data-processing-and-analysis.html#cb4-238"></a><span class="st">&quot;id&quot;</span>,</span>
<span id="cb4-239"><a href="data-processing-and-analysis.html#cb4-239"></a><span class="st">&quot;burst&quot;</span>,</span>
<span id="cb4-240"><a href="data-processing-and-analysis.html#cb4-240"></a><span class="st">&quot;abs.angle&quot;</span>,</span>
<span id="cb4-241"><a href="data-processing-and-analysis.html#cb4-241"></a><span class="st">&quot;LONGITUDE&quot;</span>,</span>
<span id="cb4-242"><a href="data-processing-and-analysis.html#cb4-242"></a><span class="st">&quot;LATITUDE&quot;</span>,</span>
<span id="cb4-243"><a href="data-processing-and-analysis.html#cb4-243"></a><span class="st">&quot;lignes&quot;</span>)</span>
<span id="cb4-244"><a href="data-processing-and-analysis.html#cb4-244"></a>vms.data &lt;-<span class="st"> </span>vms_thon[, columns]</span>
<span id="cb4-245"><a href="data-processing-and-analysis.html#cb4-245"></a><span class="kw">names</span>(vms.data) &lt;-</span>
<span id="cb4-246"><a href="data-processing-and-analysis.html#cb4-246"></a>columns &lt;-</span>
<span id="cb4-247"><a href="data-processing-and-analysis.html#cb4-247"></a><span class="kw">c</span>(<span class="st">&quot;x&quot;</span>,</span>
<span id="cb4-248"><a href="data-processing-and-analysis.html#cb4-248"></a><span class="st">&quot;y&quot;</span>,</span>
<span id="cb4-249"><a href="data-processing-and-analysis.html#cb4-249"></a><span class="st">&quot;date&quot;</span>,</span>
<span id="cb4-250"><a href="data-processing-and-analysis.html#cb4-250"></a><span class="st">&quot;id&quot;</span>,</span>
<span id="cb4-251"><a href="data-processing-and-analysis.html#cb4-251"></a><span class="st">&quot;burst&quot;</span>,</span>
<span id="cb4-252"><a href="data-processing-and-analysis.html#cb4-252"></a><span class="st">&quot;abs.angle&quot;</span>,</span>
<span id="cb4-253"><a href="data-processing-and-analysis.html#cb4-253"></a><span class="st">&quot;LONGITUDE&quot;</span>,</span>
<span id="cb4-254"><a href="data-processing-and-analysis.html#cb4-254"></a><span class="st">&quot;LATITUDE&quot;</span>,</span>
<span id="cb4-255"><a href="data-processing-and-analysis.html#cb4-255"></a><span class="st">&quot;line&quot;</span>)</span>
<span id="cb4-256"><a href="data-processing-and-analysis.html#cb4-256"></a></span>
<span id="cb4-257"><a href="data-processing-and-analysis.html#cb4-257"></a>Prox_delta &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">30</span>, <span class="dv">60</span>)</span>
<span id="cb4-258"><a href="data-processing-and-analysis.html#cb4-258"></a>DI_beta &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb4-259"><a href="data-processing-and-analysis.html#cb4-259"></a></span>
<span id="cb4-260"><a href="data-processing-and-analysis.html#cb4-260"></a><span class="kw">plots.video.dyads.allgears</span>(</span>
<span id="cb4-261"><a href="data-processing-and-analysis.html#cb4-261"></a>vms.data,</span>
<span id="cb4-262"><a href="data-processing-and-analysis.html#cb4-262"></a><span class="dt">dyads =</span> dyads_tps,</span>
<span id="cb4-263"><a href="data-processing-and-analysis.html#cb4-263"></a><span class="dt">n =</span> <span class="dv">1</span>,</span>
<span id="cb4-264"><a href="data-processing-and-analysis.html#cb4-264"></a><span class="dt">gear =</span> <span class="st">&quot;TPS&quot;</span>,</span>
<span id="cb4-265"><a href="data-processing-and-analysis.html#cb4-265"></a><span class="dt">new.variables =</span> variables,</span>
<span id="cb4-266"><a href="data-processing-and-analysis.html#cb4-266"></a>dossier.data.outputs,</span>
<span id="cb4-267"><a href="data-processing-and-analysis.html#cb4-267"></a>dossier.stats.outputs,</span>
<span id="cb4-268"><a href="data-processing-and-analysis.html#cb4-268"></a><span class="dt">text.dyads =</span> <span class="ot">TRUE</span>,</span>
<span id="cb4-269"><a href="data-processing-and-analysis.html#cb4-269"></a>video.par,</span>
<span id="cb4-270"><a href="data-processing-and-analysis.html#cb4-270"></a><span class="dt">colores =</span> <span class="kw">c</span>(<span class="st">&quot;#66c2a5&quot;</span>, <span class="st">&quot;#fc8d62&quot;</span>, <span class="st">&quot;#8da0cb&quot;</span>)</span>
<span id="cb4-271"><a href="data-processing-and-analysis.html#cb4-271"></a>)</span>
<span id="cb4-272"><a href="data-processing-and-analysis.html#cb4-272"></a><span class="co"># Since there are no dyads in group 1, there is no network analysis for this fleet.</span></span>
<span id="cb4-273"><a href="data-processing-and-analysis.html#cb4-273"></a></span>
<span id="cb4-274"><a href="data-processing-and-analysis.html#cb4-274"></a><span class="co"># For anchovy purse-seiners</span></span>
<span id="cb4-275"><a href="data-processing-and-analysis.html#cb4-275"></a></span>
<span id="cb4-276"><a href="data-processing-and-analysis.html#cb4-276"></a>dyads_aps &lt;-<span class="st"> </span><span class="kw">readRDS</span>(</span>
<span id="cb4-277"><a href="data-processing-and-analysis.html#cb4-277"></a><span class="dt">file =</span> <span class="kw">paste0</span>(</span>
<span id="cb4-278"><a href="data-processing-and-analysis.html#cb4-278"></a>dossier.data.outputs,</span>
<span id="cb4-279"><a href="data-processing-and-analysis.html#cb4-279"></a><span class="st">&#39;ClustPCAoutputs-PTM-APS-10-&#39;</span>,</span>
<span id="cb4-280"><a href="data-processing-and-analysis.html#cb4-280"></a><span class="kw">paste0</span>(variables, <span class="dt">collapse =</span> <span class="st">&#39;-&#39;</span>),</span>
<span id="cb4-281"><a href="data-processing-and-analysis.html#cb4-281"></a><span class="st">&#39;_ordered.rds&#39;</span></span>
<span id="cb4-282"><a href="data-processing-and-analysis.html#cb4-282"></a>)</span>
<span id="cb4-283"><a href="data-processing-and-analysis.html#cb4-283"></a>)</span>
<span id="cb4-284"><a href="data-processing-and-analysis.html#cb4-284"></a></span>
<span id="cb4-285"><a href="data-processing-and-analysis.html#cb4-285"></a>columns &lt;-</span>
<span id="cb4-286"><a href="data-processing-and-analysis.html#cb4-286"></a><span class="kw">c</span>(<span class="st">&quot;x&quot;</span>,</span>
<span id="cb4-287"><a href="data-processing-and-analysis.html#cb4-287"></a><span class="st">&quot;y&quot;</span>,</span>
<span id="cb4-288"><a href="data-processing-and-analysis.html#cb4-288"></a><span class="st">&quot;date&quot;</span>,</span>
<span id="cb4-289"><a href="data-processing-and-analysis.html#cb4-289"></a><span class="st">&quot;id&quot;</span>,</span>
<span id="cb4-290"><a href="data-processing-and-analysis.html#cb4-290"></a><span class="st">&quot;burst&quot;</span>,</span>
<span id="cb4-291"><a href="data-processing-and-analysis.html#cb4-291"></a><span class="st">&quot;abs.angle&quot;</span>,</span>
<span id="cb4-292"><a href="data-processing-and-analysis.html#cb4-292"></a><span class="st">&quot;LONGITUDE&quot;</span>,</span>
<span id="cb4-293"><a href="data-processing-and-analysis.html#cb4-293"></a><span class="st">&quot;LATITUDE&quot;</span>,</span>
<span id="cb4-294"><a href="data-processing-and-analysis.html#cb4-294"></a><span class="st">&quot;ligne&quot;</span>)</span>
<span id="cb4-295"><a href="data-processing-and-analysis.html#cb4-295"></a>vms.data &lt;-<span class="st"> </span>vms_aps[, columns]</span>
<span id="cb4-296"><a href="data-processing-and-analysis.html#cb4-296"></a><span class="kw">names</span>(vms.data) &lt;-</span>
<span id="cb4-297"><a href="data-processing-and-analysis.html#cb4-297"></a>columns &lt;-</span>
<span id="cb4-298"><a href="data-processing-and-analysis.html#cb4-298"></a><span class="kw">c</span>(<span class="st">&quot;x&quot;</span>,</span>
<span id="cb4-299"><a href="data-processing-and-analysis.html#cb4-299"></a><span class="st">&quot;y&quot;</span>,</span>
<span id="cb4-300"><a href="data-processing-and-analysis.html#cb4-300"></a><span class="st">&quot;date&quot;</span>,</span>
<span id="cb4-301"><a href="data-processing-and-analysis.html#cb4-301"></a><span class="st">&quot;id&quot;</span>,</span>
<span id="cb4-302"><a href="data-processing-and-analysis.html#cb4-302"></a><span class="st">&quot;burst&quot;</span>,</span>
<span id="cb4-303"><a href="data-processing-and-analysis.html#cb4-303"></a><span class="st">&quot;abs.angle&quot;</span>,</span>
<span id="cb4-304"><a href="data-processing-and-analysis.html#cb4-304"></a><span class="st">&quot;LONGITUDE&quot;</span>,</span>
<span id="cb4-305"><a href="data-processing-and-analysis.html#cb4-305"></a><span class="st">&quot;LATITUDE&quot;</span>,</span>
<span id="cb4-306"><a href="data-processing-and-analysis.html#cb4-306"></a><span class="st">&quot;line&quot;</span>)</span>
<span id="cb4-307"><a href="data-processing-and-analysis.html#cb4-307"></a></span>
<span id="cb4-308"><a href="data-processing-and-analysis.html#cb4-308"></a>Prox_delta &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>)</span>
<span id="cb4-309"><a href="data-processing-and-analysis.html#cb4-309"></a>DI_beta &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb4-310"><a href="data-processing-and-analysis.html#cb4-310"></a></span>
<span id="cb4-311"><a href="data-processing-and-analysis.html#cb4-311"></a><span class="kw">plots.video.dyads.allgears</span>(</span>
<span id="cb4-312"><a href="data-processing-and-analysis.html#cb4-312"></a>vms.data,</span>
<span id="cb4-313"><a href="data-processing-and-analysis.html#cb4-313"></a><span class="dt">dyads =</span> dyads_aps,</span>
<span id="cb4-314"><a href="data-processing-and-analysis.html#cb4-314"></a><span class="dt">n =</span> <span class="dv">1</span>,</span>
<span id="cb4-315"><a href="data-processing-and-analysis.html#cb4-315"></a><span class="dt">gear =</span> <span class="st">&quot;APS&quot;</span>,</span>
<span id="cb4-316"><a href="data-processing-and-analysis.html#cb4-316"></a><span class="dt">new.variables =</span> variables,</span>
<span id="cb4-317"><a href="data-processing-and-analysis.html#cb4-317"></a>dossier.data.outputs,</span>
<span id="cb4-318"><a href="data-processing-and-analysis.html#cb4-318"></a>dossier.stats.outputs,</span>
<span id="cb4-319"><a href="data-processing-and-analysis.html#cb4-319"></a><span class="dt">text.dyads =</span> <span class="ot">TRUE</span>,</span>
<span id="cb4-320"><a href="data-processing-and-analysis.html#cb4-320"></a>video.par,</span>
<span id="cb4-321"><a href="data-processing-and-analysis.html#cb4-321"></a><span class="dt">colores =</span> <span class="kw">c</span>(<span class="st">&quot;#66c2a5&quot;</span>, <span class="st">&quot;#fc8d62&quot;</span>, <span class="st">&quot;#8da0cb&quot;</span>)</span>
<span id="cb4-322"><a href="data-processing-and-analysis.html#cb4-322"></a>)</span>
<span id="cb4-323"><a href="data-processing-and-analysis.html#cb4-323"></a></span>
<span id="cb4-324"><a href="data-processing-and-analysis.html#cb4-324"></a><span class="kw">Fleet.Analysis</span>(</span>
<span id="cb4-325"><a href="data-processing-and-analysis.html#cb4-325"></a>vms.data,</span>
<span id="cb4-326"><a href="data-processing-and-analysis.html#cb4-326"></a><span class="dt">dyads =</span> dyads_aps,</span>
<span id="cb4-327"><a href="data-processing-and-analysis.html#cb4-327"></a>dossier.data.outputs,</span>
<span id="cb4-328"><a href="data-processing-and-analysis.html#cb4-328"></a>dossier.stats.outputs,</span>
<span id="cb4-329"><a href="data-processing-and-analysis.html#cb4-329"></a><span class="dt">gear =</span> <span class="st">&quot;APS&quot;</span></span>
<span id="cb4-330"><a href="data-processing-and-analysis.html#cb4-330"></a>)</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="supplementary-results.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
